<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>GOYTH  | Webpack 工作原理（一）——配置篇</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.65.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.1cb140d8ba31d5b2f1114537dd04802a.css" rel="stylesheet">
    

    

    
      
<link rel="shortcut icon" href="/https://img-1256541035.cos.ap-shanghai.myqcloud.com/imgs/favicon-red-bird.png" type="image/x-icon" />

    

    
    
    <meta property="og:title" content="Webpack 工作原理（一）——配置篇" />
<meta property="og:description" content="Webpack 工作原理（一）——配置篇" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://goyth.cn/2018/11/17/webpackconfig/" />
<meta property="article:published_time" content="2018-11-17T21:53:54+08:00" />
<meta property="article:modified_time" content="2018-11-17T21:53:54+08:00" />
<meta itemprop="name" content="Webpack 工作原理（一）——配置篇">
<meta itemprop="description" content="Webpack 工作原理（一）——配置篇">
<meta itemprop="datePublished" content="2018-11-17T21:53:54&#43;08:00" />
<meta itemprop="dateModified" content="2018-11-17T21:53:54&#43;08:00" />
<meta itemprop="wordCount" content="1278">



<meta itemprop="keywords" content="Nodejs,webpack," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Webpack 工作原理（一）——配置篇"/>
<meta name="twitter:description" content="Webpack 工作原理（一）——配置篇"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://goyth.cn/" class="f3 fw2 hover-white no-underline white-90 dib">
      GOYTH
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="Articles page">
              Articles
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
        </ul>
      
      




<a href="https://twitter.com/goythz" target="_blank" class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel="noopener" aria-label="follow on Twitter——Opens in a new window">
  <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>





<a href="https://github.com/jsyt" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        ARTICLES
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://goyth.cn/2018/11/17/webpackconfig/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://goyth.cn/2018/11/17/webpackconfig/&amp;text=Webpack%20%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%e9%85%8d%e7%bd%ae%e7%af%87" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://goyth.cn/2018/11/17/webpackconfig/&amp;title=Webpack%20%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86%ef%bc%88%e4%b8%80%ef%bc%89%e2%80%94%e2%80%94%e9%85%8d%e7%bd%ae%e7%af%87" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>

      <h1 class="f1 athelas mt3 mb1">Webpack 工作原理（一）——配置篇</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-11-17T21:53:54&#43;08:00">November 17, 2018</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy avenir bg-near-white f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h3 id="什么是webpack">什么是WebPack</h3>
<p>WebPack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。</p>
<p>构建就是把源代码转换成发布到线上的可执行 JavaScrip、CSS、HTML 代码，包括如下内容。</p>
<ul>
<li><strong>代码转换</strong>：TypeScript 编译成 JavaScript、SCSS 编译成 CSS 等。</li>
<li><strong>文件优化</strong>：压缩 JavaScript、CSS、HTML 代码，压缩合并图片等。</li>
<li><strong>代码分割</strong>：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li>
<li><strong>模块合并</strong>：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li>
<li><strong>自动刷新</strong>：监听本地源代码的变化，自动重新构建、刷新浏览器。</li>
<li><strong>代码校验</strong>：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li>
<li><strong>自动发布</strong>：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li>
</ul>
<p>构建其实是工程化、自动化思想在前端开发中的体现，把一系列流程用代码去实现，让代码自动化地执行这一系列复杂的流程。 构建给前端开发注入了更大的活力，解放了我们的生产力。</p>
<h3 id="webpack核心概念">webpack核心概念</h3>
<ul>
<li><strong>Entry</strong>：入口，Webpack 执行构建的第一步将从 Entry 开始，可抽象成输入。</li>
<li><strong>Module</strong>：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</li>
<li><strong>Chunk</strong>：代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</li>
<li><strong>Loader</strong>：模块转换器，用于把模块原内容按照需求转换成新内容。</li>
<li><strong>Plugin</strong>：扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li>
<li><strong>Output</strong>：输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果。</li>
</ul>
<h3 id="webpack基本配置">webpack基本配置</h3>
<h4 id="安装webpack">安装webpack</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install webpack webpack<span style="color:#ff79c6">-</span>cli <span style="color:#ff79c6">-</span>D
</code></pre></div><h4 id="创建src目录">创建src目录</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">mkdir src
</code></pre></div><h4 id="创建dist目录">创建dist目录</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">mkdir dist
</code></pre></div><h4 id="创建-webpackconfigjs-配置文件">创建 webpack.config.js 配置文件</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">touch webpack.config.js
</code></pre></div><h5 id="webpackconfigjs基本配置">webpack.config.js基本配置</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> path<span style="color:#ff79c6">=</span>require(<span style="color:#f1fa8c">&#39;path&#39;</span>);
module.exports<span style="color:#ff79c6">=</span>{
    entry<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/index.js&#39;</span>,
    output<span style="color:#ff79c6">:</span> {
        path<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;dist&#39;</span>),
        filename<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;bundle.js&#39;</span>
    },
    module<span style="color:#ff79c6">:</span> {},
    plugins<span style="color:#ff79c6">:</span> [],
    devServer<span style="color:#ff79c6">:</span> {}
}
</code></pre></div><ul>
<li>entry：配置入口文件的地址</li>
<li>output：配置出口文件的地址</li>
<li>module：配置模块,主要用来配置不同文件的加载器</li>
<li>plugins：配置插件</li>
<li>devServer：配置开发服务器</li>
</ul>
<h4 id="创建indexhtml文件">创建index.html文件</h4>
<p>在dist目录下创建index.html文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#ff79c6">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#ff79c6">html</span> <span style="color:#50fa7b">lang</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span>&gt;
&lt;<span style="color:#ff79c6">head</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">charset</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> <span style="color:#50fa7b">content</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">http-equiv</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;X-UA-Compatible&#34;</span> <span style="color:#50fa7b">content</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;ie=edge&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">title</span>&gt;Document&lt;/<span style="color:#ff79c6">title</span>&gt;
&lt;/<span style="color:#ff79c6">head</span>&gt;
&lt;<span style="color:#ff79c6">body</span>&gt;
&lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;root&#34;</span>&gt;&lt;/<span style="color:#ff79c6">div</span>&gt;
&lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;bundle.js&#34;</span>&gt;&lt;/<span style="color:#ff79c6">script</span>&gt;
&lt;/<span style="color:#ff79c6">body</span>&gt;
&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></div><h3 id="webpack-详细配置">webpack 详细配置</h3>
<h4 id="配置开发服务器">配置开发服务器</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i webpack<span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>server –D
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"> devServer<span style="color:#ff79c6">:</span>{
        contentBase<span style="color:#ff79c6">:</span>path.resolve(__dirname,<span style="color:#f1fa8c">&#39;dist&#39;</span>),
        host<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;localhost&#39;</span>,
        compress<span style="color:#ff79c6">:</span><span style="color:#ff79c6">true</span>,
        port<span style="color:#ff79c6">:</span><span style="color:#bd93f9">8080</span>
 }
  <span style="color:#f1fa8c">&#34;scripts&#34;</span><span style="color:#ff79c6">:</span> {
    <span style="color:#f1fa8c">&#34;build&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;webpack --mode development&#34;</span>,
    <span style="color:#f1fa8c">&#34;dev&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;webpack-dev-server --open --mode development &#34;</span>
  }
</code></pre></div><ul>
<li>contentBase 配置开发服务运行时的文件根目录</li>
<li>host：开发服务器监听的主机地址</li>
<li>compress 开发服务器是否启动gzip等压缩</li>
<li>port：开发服务器监听的端口</li>
</ul>
<h4 id="什么是loader">什么是Loader</h4>
<p>通过使用不同的Loader，Webpack可以要把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等</p>
<ul>
<li>test：匹配处理文件的扩展名的正则表达式</li>
<li>use：loader名称，就是你要使用模块的名称</li>
<li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li>
<li>query：为loaders提供额外的设置选项</li>
</ul>
<h5 id="loader三种写法">loader三种写法</h5>
<p><strong>支持加载css文件</strong>
加载CSS文件，CSS文件有可能在node_modules里，比如bootstrap和antd
<strong>1. loader</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module<span style="color:#ff79c6">:</span> {
        rules<span style="color:#ff79c6">:</span> [
            {
                test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.css/</span>,
                loader<span style="color:#ff79c6">:</span>[<span style="color:#f1fa8c">&#39;style-loader&#39;</span>,<span style="color:#f1fa8c">&#39;css-loader&#39;</span>]
            }
        ]
    }

</code></pre></div><p><strong>2. use</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module<span style="color:#ff79c6">:</span> {
        rules<span style="color:#ff79c6">:</span> [
            {
                test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.css/</span>,
                use<span style="color:#ff79c6">:</span>[<span style="color:#f1fa8c">&#39;style-loader&#39;</span>,<span style="color:#f1fa8c">&#39;css-loader&#39;</span>]
            }
        ]
    },

</code></pre></div><p><strong>3. use+loader</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">  module<span style="color:#ff79c6">:</span> {
      rules<span style="color:#ff79c6">:</span> [
          {
              test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.css/</span>,
              include<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;src&#39;</span>),
              exclude<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/node_modules/</span>,
              use<span style="color:#ff79c6">:</span> [{
                  loader<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;style-loader&#39;</span>,
                  options<span style="color:#ff79c6">:</span> {
                      insertAt<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;top&#39;</span>
                  }
              },<span style="color:#f1fa8c">&#39;css-loader&#39;</span>]
          }
      ]
  }

</code></pre></div><h4 id="插件">插件</h4>
<p>在 webpack 的构建流程中，plugin 用于处理更多其他的一些构建任务
模块代码转换的工作由 loader 来处理
除此之外的其他任何工作都可以交由 plugin 来完成</p>
<h4 id="自动产出html">自动产出html</h4>
<p>我们希望自动能产出HTML文件，并在里面引入产出后的资源</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i html<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin <span style="color:#ff79c6">-</span>D

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">    plugins<span style="color:#ff79c6">:</span> [
        <span style="color:#ff79c6">new</span> HtmlWebpackPlugin({
         minify<span style="color:#ff79c6">:</span> {
            removeAttributeQuotes<span style="color:#ff79c6">:</span><span style="color:#ff79c6">true</span>
        },
        hash<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
        template<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/index.html&#39;</span>,
        filename<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;index.html&#39;</span>
    })]
</code></pre></div><ul>
<li>minify 是对html文件进行压缩，removeAttrubuteQuotes是去掉属性的双引号</li>
<li>hash 引入产出资源的时候加上查询参数，值为哈希避免缓存</li>
<li>template 模版路径</li>
</ul>
<h4 id="支持图片">支持图片</h4>
<h5 id="手动添加图片">手动添加图片</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i file<span style="color:#ff79c6">-</span>loader url<span style="color:#ff79c6">-</span>loader <span style="color:#ff79c6">-</span>D
</code></pre></div><ul>
<li>file-loader 解决CSS等文件中的引入图片路径问题</li>
<li>url-loader 当图片小于limit的时候会把图片BASE64编码，大于limit参数的时候还是使用file-loader 进行拷贝</li>
</ul>
<h5 id="js中引入图片">JS中引入图片</h5>
<p><strong>JS</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8be9fd;font-style:italic">let</span> logo<span style="color:#ff79c6">=</span>require(<span style="color:#f1fa8c">&#39;./images/logo.png&#39;</span>);
<span style="color:#8be9fd;font-style:italic">let</span> img<span style="color:#ff79c6">=</span><span style="color:#ff79c6">new</span> Image();
img.src<span style="color:#ff79c6">=</span>logo;
<span style="color:#8be9fd;font-style:italic">document</span>.body.appendChild(img);
</code></pre></div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
  test<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">/\.(jpg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span>,
    use<span style="color:#ff79c6">:</span>[
    {
       loader<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;url-loader&#39;</span>,
       options<span style="color:#ff79c6">:</span>{limit<span style="color:#ff79c6">:</span><span style="color:#bd93f9">4096</span>}
    }
  ]
}
</code></pre></div><h5 id="在css中引入图片">在CSS中引入图片</h5>
<p>还可以在CSS文件中引入图片</p>
<p><strong>CSS</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">.logo{
    width<span style="color:#ff79c6">:</span><span style="color:#bd93f9">355</span>px;
    height<span style="color:#ff79c6">:</span><span style="color:#bd93f9">133</span>px;
    background<span style="color:#ff79c6">-</span>image<span style="color:#ff79c6">:</span> url(.<span style="color:#ff79c6">/</span>images<span style="color:#ff79c6">/</span>logo.png);
    background<span style="color:#ff79c6">-</span>size<span style="color:#ff79c6">:</span> cover;
}
</code></pre></div><p><strong>HTML</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">&lt;</span>div <span style="color:#ff79c6">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;logo&#34;</span><span style="color:#ff79c6">&gt;&lt;</span>/div&gt;
</code></pre></div><p><strong>分离CSS</strong>
因为CSS的下载和JS可以并行,当一个HTML文件很大的时候，我们可以把CSS单独提取出来加载</p>
<ul>
<li>mini-css-extract-plugin</li>
<li>filename 打包入口文件</li>
<li>chunkFilename 用来打包import(&lsquo;module&rsquo;)方法中引入的模块</li>
</ul>
<p>安装依赖模块</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install <span style="color:#ff79c6">--</span>save<span style="color:#ff79c6">-</span>dev mini<span style="color:#ff79c6">-</span>css<span style="color:#ff79c6">-</span>extract<span style="color:#ff79c6">-</span>plugin
</code></pre></div><p>配置webpack.config.js</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">plugins<span style="color:#ff79c6">:</span> [
       <span style="color:#6272a4">//参数类似于webpackOptions.output
</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">new</span> MiniCssExtractPlugin({
            filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;[name].css&#39;</span>,
            chunkFilename<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;[id].css&#39;</span>
        })]
module<span style="color:#ff79c6">:</span> {
  rules<span style="color:#ff79c6">:</span> [
    {
        test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.css/</span>,
        include<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;src&#39;</span>),
        exclude<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/node_modules/</span>,
        use<span style="color:#ff79c6">:</span> [{
            loader<span style="color:#ff79c6">:</span> MiniCssExtractPlugin.loader
        },<span style="color:#f1fa8c">&#39;css-loader&#39;</span>]
    }
  ]
}
</code></pre></div><h4 id="压缩js和css">压缩JS和CSS</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i uglifyjs<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin optimize<span style="color:#ff79c6">-</span>css<span style="color:#ff79c6">-</span>assets<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin <span style="color:#ff79c6">-</span>D
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> UglifyJsPlugin <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#34;uglifyjs-webpack-plugin&#34;</span>);
<span style="color:#ff79c6">const</span> OptimizeCSSAssetsPlugin <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#34;optimize-css-assets-webpack-plugin&#34;</span>);
module.exports <span style="color:#ff79c6">=</span> {
    mode<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;development&#39;</span>,
    optimization<span style="color:#ff79c6">:</span> {
        minimizer<span style="color:#ff79c6">:</span> [
            <span style="color:#ff79c6">new</span> UglifyJsPlugin({
                cache<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,<span style="color:#6272a4">//启动缓存
</span><span style="color:#6272a4"></span>                parallel<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,<span style="color:#6272a4">//启动并行压缩
</span><span style="color:#6272a4"></span>                <span style="color:#6272a4">//如果为true的话，可以获得sourcemap
</span><span style="color:#6272a4"></span>                sourceMap<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span> <span style="color:#6272a4">// set to true if you want JS source maps
</span><span style="color:#6272a4"></span>            }),
            <span style="color:#6272a4">//压缩css资源的
</span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">new</span> OptimizeCSSAssetsPlugin({})
        ]
    }
</code></pre></div><h5 id="css和image存放单独目录">css和image存放单独目录</h5>
<ul>
<li>outputPath 输出路径</li>
<li>publicPath指定的是构建后在html里的路径</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">output<span style="color:#ff79c6">:</span> {
        path<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;dist&#39;</span>),
        filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;bundle.js&#39;</span>,
        publicPath<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;/&#39;</span>
    },
module<span style="color:#ff79c6">:</span> {
  rules<span style="color:#ff79c6">:</span> [
    {
      test<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">/\.(jpg|jpeg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span>,
      use<span style="color:#ff79c6">:</span>[
            {
              loader<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;url-loader&#39;</span>,
              options<span style="color:#ff79c6">:</span>{
                  limit<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">4096</span>,
                  outputPath<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;images&#39;</span>,
                  publicPath<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;/images&#39;</span>
              }
            }
        ]
    }
  ]
},
plugins<span style="color:#ff79c6">:</span> [
        <span style="color:#ff79c6">new</span> MiniCssExtractPlugin({
            filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;css/[name].css&#39;</span>,
            chunkFilename<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;css/[id].css&#39;</span>
        })]

</code></pre></div><h4 id="在html中使用图片">在HTML中使用图片</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i html<span style="color:#ff79c6">-</span>withimg<span style="color:#ff79c6">-</span>loader <span style="color:#ff79c6">-</span>D
</code></pre></div><p>index.html</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#ff79c6">img</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;./images/logo.png&#34;</span>/&gt;
</code></pre></div><p>webpack.config.js</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
  test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.(html|htm)$/</span>,
  use<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;html-withimg-loader&#39;</span>
}
</code></pre></div><h4 id="编译less-和-sass">编译less 和 sass</h4>
<h5 id="安装less">安装less</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i less less<span style="color:#ff79c6">-</span>loader <span style="color:#ff79c6">-</span>D
npm i node<span style="color:#ff79c6">-</span>sass sass<span style="color:#ff79c6">-</span>loader <span style="color:#ff79c6">-</span>D
</code></pre></div><h5 id="编写样式">编写样式</h5>
<p>less</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css">@<span style="color:#ff79c6">color</span>:orange;
.<span style="color:#50fa7b">less-container</span>{
    <span style="color:#ff79c6">color</span>:<span style="color:#ff79c6">@</span><span style="color:#ff79c6">color</span>;
}
</code></pre></div><p>sass</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="color:#ff79c6">$</span><span style="color:#ff79c6">color</span>:green<span style="color:#ff79c6">;</span>
.<span style="color:#50fa7b">sass-container</span>{
    <span style="color:#ff79c6">color</span>:<span style="color:#ff79c6">green</span>;
}
</code></pre></div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.less/</span>,
    include<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;src&#39;</span>),
    exclude<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/node_modules/</span>,
    use<span style="color:#ff79c6">:</span> [{
        loader<span style="color:#ff79c6">:</span> MiniCssExtractPlugin.loader,
    },<span style="color:#f1fa8c">&#39;css-loader&#39;</span>,<span style="color:#f1fa8c">&#39;less-loader&#39;</span>]
},
{
    test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.scss/</span>,
    include<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;src&#39;</span>),
    exclude<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/node_modules/</span>,
    use<span style="color:#ff79c6">:</span> [{
        loader<span style="color:#ff79c6">:</span> MiniCssExtractPlugin.loader,
    },<span style="color:#f1fa8c">&#39;css-loader&#39;</span>,<span style="color:#f1fa8c">&#39;sass-loader&#39;</span>]
}
</code></pre></div><h4 id="处理css3属性前缀">处理CSS3属性前缀</h4>
<p>为了浏览器的兼容性，有时候我们必须加入-webkit,-ms,-o,-moz这些前缀</p>
<ul>
<li>Trident内核：主要代表为IE浏览器, 前缀为-ms</li>
<li>Gecko内核：主要代表为Firefox, 前缀为-moz</li>
<li>Presto内核：主要代表为Opera, 前缀为-o</li>
<li>Webkit内核：产要代表为Chrome和Safari, 前缀为 <strong>-webkit</strong></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i postcss<span style="color:#ff79c6">-</span>loader autoprefixer <span style="color:#ff79c6">-</span>D
</code></pre></div><p><strong>index.css</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css">::placeholder {
    <span style="color:#ff79c6">color</span>: <span style="color:#ff79c6">red</span>;
}
</code></pre></div><p><strong>postcss.config.js</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module.exports<span style="color:#ff79c6">=</span>{
    plugins<span style="color:#ff79c6">:</span>[require(<span style="color:#f1fa8c">&#39;autoprefixer&#39;</span>)]
}
</code></pre></div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
   test<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">/\.css$/</span>,
   use<span style="color:#ff79c6">:</span>[MiniCssExtractPlugin.loader,<span style="color:#f1fa8c">&#39;css-loader&#39;</span>,<span style="color:#f1fa8c">&#39;postcss-loader&#39;</span>],
   include<span style="color:#ff79c6">:</span>path.join(__dirname,<span style="color:#f1fa8c">&#39;./src&#39;</span>),
   exclude<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">/node_modules/</span>
}
</code></pre></div><h4 id="转义es6es7jsx">转义ES6/ES7/JSX</h4>
<p><strong>Babel</strong>其实是一个编译JavaScript的平台,可以把ES6/ES7,React的JSX转义为ES5</p>
<h4 id="babel-plugin-proposal-decorator">babel-plugin-proposal-decorator</h4>
<p><strong>安装依赖包</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i babel<span style="color:#ff79c6">-</span>loader @babel<span style="color:#ff79c6">/</span>core @babel<span style="color:#ff79c6">/</span>preset<span style="color:#ff79c6">-</span>env  @babel<span style="color:#ff79c6">/</span>preset<span style="color:#ff79c6">-</span>react  <span style="color:#ff79c6">-</span>D
npm i @babel<span style="color:#ff79c6">/</span>plugin<span style="color:#ff79c6">-</span>proposal<span style="color:#ff79c6">-</span>decorators @babel<span style="color:#ff79c6">/</span>plugin<span style="color:#ff79c6">-</span>proposal<span style="color:#ff79c6">-</span><span style="color:#ff79c6">class</span><span style="color:#ff79c6">-</span>properties <span style="color:#ff79c6">-</span>D
</code></pre></div><h4 id="decorator">decorator</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#6272a4">//Option+Shift+A
</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">function</span> readonly(target,key,discriptor) {
    discriptor.writable<span style="color:#ff79c6">=</span><span style="color:#ff79c6">false</span>;
}

<span style="color:#ff79c6">class</span> Person{
    @readonly PI<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3.14</span>;
}
<span style="color:#8be9fd;font-style:italic">let</span> p1<span style="color:#ff79c6">=</span><span style="color:#ff79c6">new</span> Person();
p1.PI<span style="color:#ff79c6">=</span><span style="color:#bd93f9">3.15</span>;
console.log(p1)
</code></pre></div><p><strong>jsconfig.json</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    <span style="color:#f1fa8c">&#34;compilerOptions&#34;</span><span style="color:#ff79c6">:</span> {
        <span style="color:#f1fa8c">&#34;experimentalDecorators&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>
    }
}
</code></pre></div><h5 id="webpackconfigjs">webpack.config.js</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.jsx?$/</span>,
    use<span style="color:#ff79c6">:</span> {
        loader<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;babel-loader&#39;</span>,
        options<span style="color:#ff79c6">:</span>{
         <span style="color:#f1fa8c">&#34;plugins&#34;</span><span style="color:#ff79c6">:</span> [
            [<span style="color:#f1fa8c">&#34;@babel/plugin-proposal-decorators&#34;</span>, { <span style="color:#f1fa8c">&#34;legacy&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span> }],
            [<span style="color:#f1fa8c">&#34;@babel/plugin-proposal-class-properties&#34;</span>, { <span style="color:#f1fa8c">&#34;loose&#34;</span> <span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span> }]
         ]
        }
    },
    include<span style="color:#ff79c6">:</span> path.join(__dirname,<span style="color:#f1fa8c">&#39;src&#39;</span>),
    exclude<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">/node_modules/</span>
}
</code></pre></div><h5 id="babel-runtime">babel runtime</h5>
<p><strong>babel</strong> 在每个文件都插入了辅助代码，使代码体积过大
babel 对一些公共方法使用了非常小的辅助代码，比如 <strong>_extend</strong>
默认情况下会被添加到每一个需要它的文件中。你可以引入 <strong>@babel/runtime</strong> 作为一个独立模块，来避免重复引入
<strong>babel-plugin-transform-runtime</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install <span style="color:#ff79c6">--</span>save<span style="color:#ff79c6">-</span>dev @babel<span style="color:#ff79c6">/</span>plugin<span style="color:#ff79c6">-</span>transform<span style="color:#ff79c6">-</span>runtime
npm install <span style="color:#ff79c6">--</span>save @babel<span style="color:#ff79c6">/</span>runtime
</code></pre></div><p><strong>.babelrc</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
  <span style="color:#f1fa8c">&#34;presets&#34;</span><span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;@babel/preset-env&#34;</span>],
  <span style="color:#f1fa8c">&#34;plugins&#34;</span><span style="color:#ff79c6">:</span> [
   [
         <span style="color:#f1fa8c">&#34;@babel/plugin-transform-runtime&#34;</span>,
         {
            <span style="color:#f1fa8c">&#34;corejs&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">false</span>,
            <span style="color:#f1fa8c">&#34;helpers&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
            <span style="color:#f1fa8c">&#34;regenerator&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
            <span style="color:#f1fa8c">&#34;useESModules&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>
        }
    ]
  ]
}
</code></pre></div><p>webpack打包的时候，会自动优化重复引入公共方法的问题</p>
<h4 id="eslint校验代码格式规范">ESLint校验代码格式规范</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install eslint eslint<span style="color:#ff79c6">-</span>loader babel<span style="color:#ff79c6">-</span>eslint <span style="color:#ff79c6">--</span>D
</code></pre></div><p><strong>.eslintrc.js</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module.exports <span style="color:#ff79c6">=</span> {
    root<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
    <span style="color:#6272a4">//指定解析器选项
</span><span style="color:#6272a4"></span>    parserOptions<span style="color:#ff79c6">:</span> {
        sourceType<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;module&#39;</span>
    },
    <span style="color:#6272a4">//指定脚本的运行环境
</span><span style="color:#6272a4"></span>    env<span style="color:#ff79c6">:</span> {
        browser<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
    },
    <span style="color:#6272a4">// 启用的规则及其各自的错误级别
</span><span style="color:#6272a4"></span>    rules<span style="color:#ff79c6">:</span> {
        <span style="color:#f1fa8c">&#34;indent&#34;</span><span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;error&#34;</span>, <span style="color:#bd93f9">4</span>],<span style="color:#6272a4">//缩进风格
</span><span style="color:#6272a4"></span>        <span style="color:#f1fa8c">&#34;quotes&#34;</span><span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;error&#34;</span>, <span style="color:#f1fa8c">&#34;double&#34;</span>],<span style="color:#6272a4">//引号类型
</span><span style="color:#6272a4"></span>        <span style="color:#f1fa8c">&#34;semi&#34;</span><span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;error&#34;</span>, <span style="color:#f1fa8c">&#34;always&#34;</span>],<span style="color:#6272a4">//关闭语句强制分号结尾
</span><span style="color:#6272a4"></span>        <span style="color:#f1fa8c">&#34;no-console&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;error&#34;</span>,<span style="color:#6272a4">//禁止使用console
</span><span style="color:#6272a4"></span>        <span style="color:#f1fa8c">&#34;arrow-parens&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#bd93f9">0</span> <span style="color:#6272a4">//箭头函数用小括号括起来
</span><span style="color:#6272a4"></span>    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module<span style="color:#ff79c6">:</span> {
    <span style="color:#6272a4">//配置加载规则
</span><span style="color:#6272a4"></span>    rules<span style="color:#ff79c6">:</span> [
        {
            test<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/\.js$/</span>,
            loader<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;eslint-loader&#39;</span>,
            enforce<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;pre&#34;</span>,
            include<span style="color:#ff79c6">:</span> [path.resolve(__dirname, <span style="color:#f1fa8c">&#39;src&#39;</span>)], <span style="color:#6272a4">// 指定检查的目录
</span><span style="color:#6272a4"></span>            options<span style="color:#ff79c6">:</span> { fix<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span> } <span style="color:#6272a4">// 这里的配置项参数将会被传递到 eslint 的 CLIEngine
</span><span style="color:#6272a4"></span>        },
</code></pre></div><h4 id="如何调试打包后的代码">如何调试打包后的代码</h4>
<p>webpack通过配置可以自动给我们source maps文件，map文件是一种对应编译文件和源文件的方法</p>
<ul>
<li><strong>source-map</strong>把映射文件生成到单独的文件，最完整最慢</li>
<li><strong>cheap-module-source-map</strong> 在一个单独的文件中产生一个不带列映射的Map</li>
<li><strong>eval-source-map</strong> 使用eval打包源文件模块,在同一个文件中生成完整sourcemap</li>
<li><strong>cheap-module-eval-source-map</strong> sourcemap和打包后的JS同行显示，没有映射列</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">devtool<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;eval-source-map&#39;</span>
</code></pre></div><h4 id="打包第三方类库">打包第三方类库</h4>
<h5 id="直接引入">直接引入</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">import</span> _ from <span style="color:#f1fa8c">&#39;lodash&#39;</span>;
alert(_.join([<span style="color:#f1fa8c">&#39;a&#39;</span>,<span style="color:#f1fa8c">&#39;b&#39;</span>,<span style="color:#f1fa8c">&#39;c&#39;</span>],<span style="color:#f1fa8c">&#39;@&#39;</span>));
</code></pre></div><h5 id="插件引入">插件引入</h5>
<ul>
<li>_ 函数会自动添加到当前模块的上下文，无需显示声明</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> webpack.ProvidePlugin({
   _<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;lodash&#39;</span>
})
</code></pre></div><p>没有全局的$函数，所以导入依赖全局变量的插件依旧会失败</p>
<h5 id="expose-loader">expose-loader</h5>
<p>不需要任何其他的插件配合，只要将下面的代码添加到所有的loader之前</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">require(<span style="color:#f1fa8c">&#34;expose-loader?libraryName!./file.js&#34;</span>);
{
    test<span style="color:#ff79c6">:</span> require.resolve(<span style="color:#f1fa8c">&#34;jquery&#34;</span>),
    loader<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;expose-loader?jQuery&#34;</span>
}
require(<span style="color:#f1fa8c">&#34;expose-loader?$!jquery&#34;</span>);
</code></pre></div><h5 id="externals">externals</h5>
<p>如果我们想引用一个库，但是又不想让webpack打包，并且又不影响我们在程序中以CMD、AMD或者window/global全局等方式进行使用，那就可以通过配置externals</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> jQuery <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#34;jquery&#34;</span>);
<span style="color:#ff79c6">import</span> jQuery from <span style="color:#f1fa8c">&#39;jquery&#39;</span>;
externals<span style="color:#ff79c6">:</span> {
  jquery<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;jQuery&#39;</span><span style="color:#6272a4">//如果要在浏览器中运行，那么不用添加什么前缀，默认设置就是global
</span><span style="color:#6272a4"></span>},
module<span style="color:#ff79c6">:</span> {}
</code></pre></div><h4 id="watch">watch</h4>
<p>当代码发生修改后可以自动重新编译</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">watch<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
watchOptions<span style="color:#ff79c6">:</span> {
    ignored<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/node_modules/</span>, <span style="color:#6272a4">//忽略不用监听变更的目录
</span><span style="color:#6272a4"></span>    poll<span style="color:#ff79c6">:</span><span style="color:#bd93f9">1000</span>, <span style="color:#6272a4">//每秒询问的文件变更的次数
</span><span style="color:#6272a4"></span>    aggregateTimeout<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">500</span>, <span style="color:#6272a4">//防止重复保存频繁重新编译,500毫秒内重复保存不打包
</span><span style="color:#6272a4"></span>}
</code></pre></div><p>webpack定时获取文件的更新时间，并跟上次保存的时间进行比对，不一致就表示发生了变化,poll就用来配置每秒问多少次
当检测文件不再发生变化，会先缓存起来，等待一段时间后之后再通知监听者，这个等待时间通过aggregateTimeout配置
webpack只会监听entry依赖的文件
我们需要尽可能减少需要监听的文件数量和检查频率，当然频率的降低会导致灵敏度下降</p>
<h4 id="添加商标">添加商标</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> webpack.BannerPlugin(<span style="color:#f1fa8c">&#39;Garmin&#39;</span>),
</code></pre></div><h4 id="拷贝静态文件">拷贝静态文件</h4>
<p>有时项目中没有引用的文件也需要打包到目标目录</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i copy<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin <span style="color:#ff79c6">-</span>D
<span style="color:#ff79c6">new</span> CopyWebpackPlugin([{
  from<span style="color:#ff79c6">:</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;src/assets&#39;</span>),<span style="color:#6272a4">//静态资源目录源地址
</span><span style="color:#6272a4"></span>  to<span style="color:#ff79c6">:</span>path.resolve(__dirname,<span style="color:#f1fa8c">&#39;dist/assets&#39;</span>) <span style="color:#6272a4">//目标地址，相对于output的path目录
</span><span style="color:#6272a4"></span>}])
</code></pre></div><h4 id="打包前先清空输出目录">打包前先清空输出目录</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm i  clean<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin <span style="color:#ff79c6">-</span>D
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> CleanWebpackPlugin([path.resolve(__dirname,<span style="color:#f1fa8c">&#39;dist&#39;</span>)])
</code></pre></div><h4 id="服务器代理">服务器代理</h4>
<p>如果你有单独的后端开发服务器 API，并且希望在同域名下发送 API 请求 ，那么代理某些 URL 会很有用。</p>
<h5 id="不修改路径">不修改路径</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#6272a4">//请求到 /api/users 现在会被代理到请求 http://localhost:3000/api/users。
</span><span style="color:#6272a4"></span>
proxy<span style="color:#ff79c6">:</span> {
  <span style="color:#f1fa8c">&#34;/api&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;http://localhost:3000&#39;</span>
}
</code></pre></div><h4 id="修改路径">修改路径</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">proxy<span style="color:#ff79c6">:</span> {
    <span style="color:#f1fa8c">&#34;/api&#34;</span><span style="color:#ff79c6">:</span> {
       target<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;http://localhost:3000&#39;</span>,
       pathRewrite<span style="color:#ff79c6">:</span>{<span style="color:#f1fa8c">&#34;^/api&#34;</span><span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#34;&#34;</span>}
    }
}
</code></pre></div><h4 id="before-after">before after</h4>
<p>before 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">before(app){
  app.get(<span style="color:#f1fa8c">&#39;/api/users&#39;</span>, <span style="color:#8be9fd;font-style:italic">function</span>(req, res) {
    res.json([{id<span style="color:#ff79c6">:</span><span style="color:#bd93f9">1</span>,name<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;zfpx1&#39;</span>}])
  })
}
</code></pre></div><h4 id="webpack-dev-middleware">webpack-dev-middleware</h4>
<p>webpack-dev-middleware就是在 Express 中提供 webpack-dev-server 静态服务能力的一个中间件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install webpack<span style="color:#ff79c6">-</span>dev<span style="color:#ff79c6">-</span>middleware <span style="color:#ff79c6">--</span>save<span style="color:#ff79c6">-</span>dev
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> express <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;express&#39;</span>);
<span style="color:#ff79c6">const</span> app <span style="color:#ff79c6">=</span> express();
<span style="color:#ff79c6">const</span> webpack <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;webpack&#39;</span>);
<span style="color:#ff79c6">const</span> webpackDevMiddleware <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;webpack-dev-middleware&#39;</span>);
<span style="color:#ff79c6">const</span> webpackOptions <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;./webpack.config&#39;</span>);
webpackOptions.mode <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;development&#39;</span>;
<span style="color:#ff79c6">const</span> compiler <span style="color:#ff79c6">=</span> webpack(webpackOptions);
app.use(webpackDevMiddleware(compiler, {}));
app.listen(<span style="color:#bd93f9">3000</span>);
</code></pre></div><p>webpack-dev-server 的好处是相对简单，直接安装依赖后执行命令即可
而使用webpack-dev-middleware的好处是可以在既有的 Express 代码基础上快速添加 webpack-dev-server 的功能，同时利用 Express 来根据需要添加更多的功能，如 mock 服务、代理 API 请求等</p>
<h3 id="resolve解析">resolve解析</h3>
<h4 id="extensions">extensions</h4>
<p>指定extension之后可以不用在require或是import的时候加文件扩展名,会依次尝试添加扩展名进行匹配</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">resolve<span style="color:#ff79c6">:</span> {
  extensions<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;.js&#34;</span>,<span style="color:#f1fa8c">&#34;.jsx&#34;</span>,<span style="color:#f1fa8c">&#34;.json&#34;</span>,<span style="color:#f1fa8c">&#34;.css&#34;</span>]
},
</code></pre></div><h4 id="alias">alias</h4>
<p>配置别名可以加快webpack查找模块的速度</p>
<p>每当引入bootstrap模块的时候，它会直接引入bootstrap,而不需要从node_modules文件夹中按模块的查找规则查找</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> bootstrap <span style="color:#ff79c6">=</span> path.resolve(__dirname,<span style="color:#f1fa8c">&#39;node_modules/_bootstrap@3.3.7@bootstrap/dist/css/bootstrap.css&#39;</span>);
resolve<span style="color:#ff79c6">:</span> {
  alias<span style="color:#ff79c6">:</span>{
      <span style="color:#f1fa8c">&#34;bootstrap&#34;</span><span style="color:#ff79c6">:</span>bootstrap
  }
},
</code></pre></div><h4 id="modules">modules</h4>
<p>对于直接声明依赖名的模块（如 react ），webpack 会类似 Node.js 一样进行路径搜索，搜索node_modules目录
这个目录就是使用resolve.modules字段进行配置的 默认配置</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">resolve<span style="color:#ff79c6">:</span> {
modules<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#39;node_modules&#39;</span>],
}
</code></pre></div><p>如果可以确定项目内所有的第三方依赖模块都是在项目根目录下的 node_modules 中的话</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">resolve<span style="color:#ff79c6">:</span> {
modules<span style="color:#ff79c6">:</span> [path.resolve(__dirname, <span style="color:#f1fa8c">&#39;node_modules&#39;</span>)],
}
</code></pre></div><h4 id="mainfields">mainFields</h4>
<p>默认情况下package.json 文件则按照文件中 main 字段的文件名来查找文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">resolve<span style="color:#ff79c6">:</span> {
  <span style="color:#6272a4">// 配置 target === &#34;web&#34; 或者 target === &#34;webworker&#34; 时 mainFields 默认值是：
</span><span style="color:#6272a4"></span>  mainFields<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#39;browser&#39;</span>, <span style="color:#f1fa8c">&#39;module&#39;</span>, <span style="color:#f1fa8c">&#39;main&#39;</span>],
  <span style="color:#6272a4">// target 的值为其他时，mainFields 默认值为：
</span><span style="color:#6272a4"></span>  mainFields<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;module&#34;</span>, <span style="color:#f1fa8c">&#34;main&#34;</span>],
}
</code></pre></div><h4 id="mainfiles">mainFiles</h4>
<p>当目录下没有 package.json 文件时，我们说会默认使用目录下的 index.js 这个文件，其实这个也是可以配置的</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">resolve<span style="color:#ff79c6">:</span> {
  mainFiles<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#39;index&#39;</span>], <span style="color:#6272a4">// 你可以添加其他默认使用的文件名
</span><span style="color:#6272a4"></span>},
</code></pre></div><h4 id="resolveloader">resolveLoader</h4>
<p>resolve.resolveLoader用于配置解析 loader 时的 resolve 配置,默认的配置：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module.exports <span style="color:#ff79c6">=</span> {
  resolveLoader<span style="color:#ff79c6">:</span> {
    modules<span style="color:#ff79c6">:</span> [ <span style="color:#f1fa8c">&#39;node_modules&#39;</span> ],
    extensions<span style="color:#ff79c6">:</span> [ <span style="color:#f1fa8c">&#39;.js&#39;</span>, <span style="color:#f1fa8c">&#39;.json&#39;</span> ],
    mainFields<span style="color:#ff79c6">:</span> [ <span style="color:#f1fa8c">&#39;loader&#39;</span>, <span style="color:#f1fa8c">&#39;main&#39;</span> ]
  }
};
</code></pre></div><h4 id="noparse">noParse</h4>
<p>module.noParse 字段，可以用于配置哪些模块文件的内容不需要进行解析
不需要解析依赖（即无依赖） 的第三方大型类库等，可以通过这个字段来配置，以提高整体的构建速度</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">module.exports <span style="color:#ff79c6">=</span> {
<span style="color:#6272a4">// ...
</span><span style="color:#6272a4"></span>  module<span style="color:#ff79c6">:</span> {
    noParse<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">/jquery|lodash/</span>, <span style="color:#6272a4">// 正则表达式
</span><span style="color:#6272a4"></span>    <span style="color:#6272a4">// 或者使用函数
</span><span style="color:#6272a4"></span>    noParse(content) {
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">/jquery|lodash/</span>.test(content)
    },
  }
}
</code></pre></div><p>使用 noParse 进行忽略的模块文件中不能使用 import、require、define 等导入机制</p>
<h3 id="defineplugin">DefinePlugin</h3>
<p>DefinePlugin创建一些在编译时可以配置的全局常量</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> webpack.DefinePlugin({
    PRODUCTION<span style="color:#ff79c6">:</span> JSON.stringify(<span style="color:#ff79c6">true</span>),
    VERSION<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;1&#34;</span>,
    EXPRESSION<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;1+2&#34;</span>,
    COPYRIGHT<span style="color:#ff79c6">:</span> {
        AUTHOR<span style="color:#ff79c6">:</span> JSON.stringify(<span style="color:#f1fa8c">&#34;珠峰培训&#34;</span>)
    }
})
console.log(PRODUCTION);
console.log(VERSION);
console.log(EXPRESSION);
console.log(COPYRIGHT);
</code></pre></div><p>如果配置的值是字符串，那么整个字符串会被当成代码片段来执行，其结果作为最终变量的值
如果配置的值不是字符串，也不是一个对象字面量，那么该值会被转为一个字符串，如 true，最后的结果是 &lsquo;true&rsquo;
如果配置的是一个对象字面量，那么该对象的所有 key 会以同样的方式去定义
<code>JSON.stringify(true)</code> 的结果是 &lsquo;true&rsquo;</p>
<h3 id="ignoreplugin">IgnorePlugin</h3>
<p>IgnorePlugin用于忽略某些特定的模块，让 webpack 不把这些指定的模块打包进去</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">import</span> moment from  <span style="color:#f1fa8c">&#39;moment&#39;</span>;
console.log(moment);
<span style="color:#ff79c6">new</span> webpack.IgnorePlugin(<span style="color:#f1fa8c">/^\.\/locale/</span>,<span style="color:#f1fa8c">/moment$/</span>)
</code></pre></div><ul>
<li>第一个是匹配引入模块路径的正则表达式</li>
<li>第二个是匹配模块的对应上下文，即所在目录名</li>
</ul>
<h3 id="区分环境变量">区分环境变量</h3>
<ul>
<li>日常的前端开发工作中，一般都会有两套构建环境</li>
<li>一套开发时使用，构建结果用于本地开发调试，不进行代码压缩，打印 debug 信息，包含 sourcemap 文件</li>
<li>一套构建后的结果是直接应用于线上的，即代码都是压缩后，运行时不打印 debug 信息，静态文件不包括 sourcemap</li>
<li>webpack 4.x 版本引入了 mode 的概念
当你指定使用 production mode 时，默认会启用各种性能优化的功能，包括构建结果优化以及 webpack 运行性能优化
而如果是 development mode 的话，则会开启 debug 工具，运行时打印详细的错误信息，以及更加快速的增量编译构建</li>
</ul>
<h4 id="环境差异">环境差异</h4>
<ul>
<li>生产环境
<ul>
<li>可能需要分离 CSS 成单独的文件，以便多个页面共享同一个 CSS 文件</li>
<li>需要压缩 HTML/CSS/JS 代码</li>
<li>需要压缩图片</li>
</ul>
</li>
<li>开发环境
<ul>
<li>需要生成 sourcemap 文件</li>
<li>需要打印 debug 信息</li>
<li>需要 live reload 或者 hot reload 的功能&hellip;</li>
</ul>
</li>
</ul>
<h4 id="获取mode参数">获取mode参数</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">npm install <span style="color:#ff79c6">--</span>save<span style="color:#ff79c6">-</span>dev optimize<span style="color:#ff79c6">-</span>css<span style="color:#ff79c6">-</span>assets<span style="color:#ff79c6">-</span>webpack<span style="color:#ff79c6">-</span>plugin
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> UglifyJSPlugin <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;webpack/lib/optimize/UglifyJsPlugin&#39;</span>);
<span style="color:#ff79c6">const</span> OptimizeCssAssetsPlugin <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;optimize-css-assets-webpack-plugin&#39;</span>);
module.exports<span style="color:#ff79c6">=</span>(env,argv) =&gt; ({
    optimization<span style="color:#ff79c6">:</span> {
        minimizer<span style="color:#ff79c6">:</span> argv.mode <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;production&#39;</span><span style="color:#ff79c6">?</span>[
            <span style="color:#ff79c6">new</span> UglifyJSplugin({
                  cache<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,<span style="color:#6272a4">//启用缓存
</span><span style="color:#6272a4"></span>                  parallel<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,<span style="color:#6272a4">// 使用多进程运行改进编译速度
</span><span style="color:#6272a4"></span>                  sourceMap<span style="color:#ff79c6">:</span><span style="color:#ff79c6">true</span><span style="color:#6272a4">//生成sourceMap映射文件
</span><span style="color:#6272a4"></span>            }),
            <span style="color:#ff79c6">new</span> OptimizeCssAssetsWebpackPlugin({})
        ]<span style="color:#ff79c6">:</span>[]
    }
})
</code></pre></div><h4 id="封装log方法">封装log方法</h4>
<p>webpack 时传递的 mode 参数，是可以在我们的应用代码运行时，通过 <code>process.env.NODE_ENV</code> 这个变量获取</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> <span style="color:#8be9fd;font-style:italic">function</span> log(...args) {
    <span style="color:#ff79c6">if</span> (process.env.NODE_ENV <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;development&#39;</span>) {
        console.log.apply(console,args);
    }
}
</code></pre></div><h3 id="拆分配置">拆分配置</h3>
<p>可以把 webpack 的配置按照不同的环境拆分成多个文件，运行时直接根据环境变量加载对应的配置即可</p>
<ul>
<li>webpack.base.js：基础部分，即多个文件中共享的配置</li>
<li>webpack.development.js：开发环境使用的配置</li>
<li>webpack.production.js：生产环境使用的配置</li>
<li>webpack.test.js：测试环境使用的配置&hellip;</li>
<li>webpack-merge</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> { smart } <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;webpack-merge&#39;</span>)
<span style="color:#ff79c6">const</span> webpack <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;webpack&#39;</span>)
<span style="color:#ff79c6">const</span> base <span style="color:#ff79c6">=</span> require(<span style="color:#f1fa8c">&#39;./webpack.base.js&#39;</span>)
module.exports <span style="color:#ff79c6">=</span> smart(base, {
  module<span style="color:#ff79c6">:</span> {
    rules<span style="color:#ff79c6">:</span> [],
  }
})
</code></pre></div><h4 id="多入口">多入口</h4>
<p>有时候我们的页面可以不止一个HTML页面，会有多个页面，所以就需要多入口</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> path<span style="color:#ff79c6">=</span>require(<span style="color:#f1fa8c">&#39;path&#39;</span>);
<span style="color:#ff79c6">const</span> HtmlWebpackPlugin<span style="color:#ff79c6">=</span>require(<span style="color:#f1fa8c">&#39;html-webpack-plugin&#39;</span>);
module.exports<span style="color:#ff79c6">=</span>{
    entry<span style="color:#ff79c6">:</span> {
        index<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/index.js&#39;</span>,
        login<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/login.js&#39;</span>
    },
    output<span style="color:#ff79c6">:</span> {
        path<span style="color:#ff79c6">:</span> path.resolve(__dirname, <span style="color:#f1fa8c">&#39;dist&#39;</span>),
        filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;[name].[hash].js&#39;</span>,
        publicPath<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;/&#39;</span>
    },
    plugins<span style="color:#ff79c6">:</span> [
        <span style="color:#ff79c6">new</span> HtmlWebpackPlugin({
            minify<span style="color:#ff79c6">:</span> {
                removeAttributeQuotes<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>
            },
            hash<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
            template<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/index.html&#39;</span>,
            chunks<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#39;index&#39;</span>],
            filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;index.html&#39;</span>
        }),
        <span style="color:#ff79c6">new</span> HtmlWebpackPlugin({
            minify<span style="color:#ff79c6">:</span> {
                removeAttributeQuotes<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>
            },
            hash<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
            chunks<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#39;login&#39;</span>],
            template<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;./src/login.html&#39;</span>,
            filename<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;login.html&#39;</span>
        })
    ],
}
</code></pre></div><ul class="pa0">
  
   <li class="list">
     <a href="/tags/nodejs" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Nodejs</a>
   </li>
  
   <li class="list">
     <a href="/tags/webpack" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">webpack</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">What&#39;s in this posts</p>
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#什么是webpack">什么是WebPack</a></li>
        <li><a href="#webpack核心概念">webpack核心概念</a></li>
        <li><a href="#webpack基本配置">webpack基本配置</a></li>
        <li><a href="#webpack-详细配置">webpack 详细配置</a></li>
        <li><a href="#resolve解析">resolve解析</a></li>
        <li><a href="#defineplugin">DefinePlugin</a></li>
        <li><a href="#ignoreplugin">IgnorePlugin</a></li>
        <li><a href="#区分环境变量">区分环境变量</a></li>
        <li><a href="#拆分配置">拆分配置</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://goyth.cn/" >
    &copy;  GOYTH 2020 
  </a>
    <div>




<a href="https://twitter.com/goythz" target="_blank" class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel="noopener" aria-label="follow on Twitter——Opens in a new window">
  <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>





<a href="https://github.com/jsyt" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>






</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
