<!DOCTYPE html>
<html lang='en'>
  <head>
  <title>Mongo d b 知识点梳理（一） | Luke&#39;s blog</title>
  <meta charset='utf-8'>
  <meta name = 'viewport' content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'>
  <meta http-equiv = 'X-UA-Compatible' content = 'IE=edge'>
  <meta name = 'SKYPE_TOOLBAR' content = 'SKYPE_TOOLBAR_PARSER_COMPATIBLE' /><meta name = 'keywords' content = 'Luke&#39;s blog'>
<meta property = 'og:locale' content = 'en_US' />
<meta property = 'og:type' content = 'article' />
<meta property = 'og:title' content = 'MongoDB 知识点梳理（一）' />
<meta property = 'og:description' content = 'MongoDB是一个基于分布式文件存储的开源数据库系统。在高负载的情况下，添加更多的节点，可以保证服务器性能。 MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。 MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成。MongoDB …'>
<meta property = 'og:url' content = 'http://www.ytop.net/post/mongodb/' />
<meta property = 'og:image' content = 'images/%!s()'/>
<link rel='apple-touch-icon' sizes='180x180' href='http://www.ytop.net/images/icons/apple-touch-icon.png'>
<link rel='icon' type='image/png' sizes='32x32' href='http://www.ytop.net/images/icons/favicon-32x32.png'>
<link rel='icon' type='image/png' sizes='16x16' href='http://www.ytop.net/images/icons/favicon-16x16.png'>
<link rel='manifest' href='http://www.ytop.net/images/icons/site.webmanifest'>
<meta name='msapplication-TileColor' content='#da532c'>
<meta name='theme-color' content='#ffffff'>

  <link rel='canonical' href='http://www.ytop.net/post/mongodb/'>
  
  <link rel = 'stylesheet' href = 'http://www.ytop.net/css/main.d04b196130c747a0d717ed4f3cb6b3feab09912c6eb83f4b9231a26aa0c98a9ebf4b6196e93f82f8d8fce5036c3340891060627046a9c02583cbbfc80396cdd2.css'>
</head>

  <body>
    <div class = 'nav-drop'>
  <div class = 'nav-body'>
    
      <a href = 'http://www.ytop.net' class = 'nav_item'>Home</a>
    
      <a href = 'http://www.ytop.net/categories' class = 'nav_item'>Category</a>
    
      <a href = 'http://www.ytop.net/tags' class = 'nav_item'>Tag</a>
    
      <a href = 'http://www.ytop.net/about/' class = 'nav_item'>About</a>
    
    <div class = 'nav-close'></div>
    <div class = 'color_mode'>
<label for = 'mode'>Toggle Dark Mode</label>
<input type = 'checkbox' class = 'color_choice' id = 'mode'>
</div>

  </div>
</div>
<header class = 'nav' >
  <nav class = 'nav-menu'>
    <a href='http://www.ytop.net' class = 'nav-brand nav_item'>Luke&#39;s blog</a>
    <div class = 'nav_bar-wrap'>
      <div class = 'nav_bar'></div>
    </div>
  </nav>
</header>


    <main>
      
  <div class = 'wrap mt post'>
    <div><p class = 'post_date pale'>12. October 2018</p>
      <h1 class = 'post_title'>MongoDB 知识点梳理（一）</h1>
      <div class = 'post_body'>
        <div class = 'post_inner'>
        
        
          <h3 id="mongodb介绍">MongoDB介绍</h3>
<p>MongoDB是一个基于分布式文件存储的开源数据库系统。在高负载的情况下，添加更多的节点，可以保证服务器性能。
MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。
MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p>
<h3 id="mongodb-基本概念">MongoDB 基本概念</h3>
<h4 id="数据库">数据库</h4>
<p>MongoDB的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中。</p>
<p>&ldquo;show dbs&rdquo; 命令可以显示所有数据的列表。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ ./mongo
MongoDB shell version: 3.0.6
connecting to: <span class="nb">test</span>
&gt; show dbs
admin  0.000GB
<span class="nb">local</span>  0.078GB
<span class="nb">test</span>   0.078GB
&gt;
</code></pre></td></tr></table>
</div>
</div><p>执行 &ldquo;db&rdquo; 命令可以显示当前数据库对象或集合。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ ./mongo
MongoDB shell version: 3.0.6
connecting to: <span class="nb">test</span>
&gt; db
<span class="nb">test</span>
&gt;
</code></pre></td></tr></table>
</div>
</div><p>运行&quot;use&quot;命令，可以连接到一个指定的数据库。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">&gt; use <span class="nb">local</span>
switched to db <span class="nb">local</span>
&gt; db
<span class="nb">local</span>
&gt;
</code></pre></td></tr></table>
</div>
</div><p>数据库名可以是满足以下条件的任意UTF-8字符串。</p>
<ul>
<li>不能是空字符串（&quot;&quot;)。</li>
<li>不得含有&rsquo; &lsquo;（空格)、.、$、/、\和\0 (空字符)。</li>
<li>应全部小写。</li>
<li>最多64字节。</li>
<li>有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库。</li>
</ul>
<p><strong>admin</strong>： 从权限的角度来看，这是&quot;root&quot;数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。
<strong>local</strong>: 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合
config: 当Mongo用于分片设置时，config数据库在内部使用，用于保存分片的相关信息。</p>
<h4 id="文档">文档</h4>
<p>文档是一组键值(key-value)对(即BSON)。MongoDB 的文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型，这与关系型数据库有很大的区别，也是 MongoDB 非常突出的特点。</p>
<h4 id="rdbms关系型数据库与mongodb对应术语">RDBMS（关系型数据库）与MongoDB对应术语</h4>
<table>
<thead>
<tr>
<th align="center">RDBMS</th>
<th align="center">MongoDB</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">数据库</td>
<td align="center">数据库</td>
</tr>
<tr>
<td align="center">表格</td>
<td align="center">集合</td>
</tr>
<tr>
<td align="center">行</td>
<td align="center">文档</td>
</tr>
<tr>
<td align="center">列</td>
<td align="center">字段</td>
</tr>
<tr>
<td align="center">表联合</td>
<td align="center">嵌入文档</td>
</tr>
<tr>
<td align="center">主键</td>
<td align="center">主键 (MongoDB 提供了 key 为 _id )</td>
</tr>
</tbody>
</table>
<p>需要注意的是：</p>
<ul>
<li>文档中的键/值对是有序的。</li>
<li>文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚- 至可以是整个嵌入的文档)。</li>
<li>MongoDB区分类型和大小写。</li>
<li>MongoDB的文档不能有重复的键。</li>
<li>文档的键是字符串。除了少数例外情况，键可以使用任意UTF-8字符。</li>
</ul>
<h4 id="文档键命名规范">文档键命名规范：</h4>
<ul>
<li>键不能含有\0 (空字符)。这个字符用来表示键的结尾。</li>
<li>.和$有特别的意义，只有在特定环境下才能使用。</li>
<li>以下划线&rdquo;_&ldquo;开头的键是保留的(不是严格要求的)。</li>
</ul>
<h4 id="集合">集合</h4>
<p>集合就是 MongoDB 文档组，类似于 RDBMS （关系数据库管理系统：Relational Database Management System)中的表格。
集合存在于数据库中，集合没有固定的结构，这意味着你在对集合可以插入不同格式和类型的数据，但通常情况下我们插入集合的数据都会有一定的关联性。</p>
<h4 id="mongodb-数据类型">MongoDB 数据类型</h4>
<table>
<thead>
<tr>
<th align="center">数据类型</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">String</td>
<td align="center">字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。</td>
</tr>
<tr>
<td align="center">Integer</td>
<td align="center">整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。</td>
</tr>
<tr>
<td align="center">Boolean</td>
<td align="center">布尔值。用于存储布尔值（真/假）。</td>
</tr>
<tr>
<td align="center">Double</td>
<td align="center">双精度浮点值。用于存储浮点值。</td>
</tr>
<tr>
<td align="center">Min/Max keys</td>
<td align="center">将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。</td>
</tr>
<tr>
<td align="center">Array</td>
<td align="center">用于将数组或列表或多个值存储为一个键。</td>
</tr>
<tr>
<td align="center">Timestamp</td>
<td align="center">时间戳。记录文档修改或添加的具体时间。</td>
</tr>
<tr>
<td align="center">Object</td>
<td align="center">用于内嵌文档。</td>
</tr>
<tr>
<td align="center">Null</td>
<td align="center">用于创建空值。</td>
</tr>
<tr>
<td align="center">Symbol</td>
<td align="center">符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。</td>
</tr>
<tr>
<td align="center">Date</td>
<td align="center">日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。</td>
</tr>
<tr>
<td align="center">Object ID</td>
<td align="center">对象 ID。用于创建文档的 ID。</td>
</tr>
<tr>
<td align="center">Binary Data</td>
<td align="center">二进制数据。用于存储二进制数据。</td>
</tr>
<tr>
<td align="center">Code</td>
<td align="center">代码类型。用于在文档中存储 JavaScript 代码。</td>
</tr>
<tr>
<td align="center">Regular expression</td>
<td align="center">正则表达式类型。用于存储正则表达式。</td>
</tr>
</tbody>
</table>
<h4 id="objectid">ObjectId</h4>
<p>ObjectId 类似唯一主键，可以很快的去生成和排序，包含 12 bytes，含义是：</p>
<p>前 4 个字节表示创建 unix 时间戳,格林尼治时间 UTC 时间，比北京时间晚了 8 个小时
接下来的 3 个字节是机器标识码
紧接的两个字节由进程 id 组成 PID
最后三个字节是随机数</p>
<p>MongoDB 中存储的文档必须有一个 _id 键。这个键的值可以是任何类型的，默认是个 ObjectId 对象</p>
<p>由于 ObjectId 中保存了创建的时间戳，所以你不需要为你的文档保存时间戳字段，你可以通过 getTimestamp 函数来获取文档的创建时间:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">&gt; ObjectId<span class="o">()</span>.getTimestamp<span class="o">()</span>
ISODate<span class="o">(</span><span class="s2">&#34;2018-10-12T14:07:33Z&#34;</span><span class="o">)</span>
&gt;
</code></pre></td></tr></table>
</div>
</div><h3 id="数据库操作">数据库操作</h3>
<h4 id="创建数据库">创建数据库</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">use database_name     // database_name代表数据库的名字
</code></pre></td></tr></table>
</div>
</div><p>如果数据库不存在，则创建数据库，否则切换到指定数据库。</p>
<h4 id="查看数据库">查看数据库</h4>
<h5 id="查看所有数据库">查看所有数据库</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">show</span> <span class="nx">dbs</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="查看当前数据库">查看当前数据库</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span>
<span class="c1">// 或者
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">getName</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除数据库">删除数据库</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">dropDatabase</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建集合">创建集合</h4>
<h5 id="创建一个空集合">创建一个空集合</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="nx">collection_Name</span><span class="p">)</span>
<span class="c1">//collection_Name集合的名称
</span></code></pre></td></tr></table>
</div>
</div><h5 id="创建集合并插入一个文档">创建集合并插入一个文档</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//collection_Name集合的名称
</span><span class="c1">//document要插入的文档
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nx">collection_Name</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nb">document</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="插入文档">插入文档</h4>
<h5 id="insert">insert</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nb">document</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>参数</strong></p>
<ul>
<li>collection_name 集合的名字</li>
<li>document 插入的文档</li>
</ul>
<blockquote>
<p>每当插入一条新文档的时候mongodb会自动为此文档生成一个_id属性,_id一定是唯一的，用来唯一标识一个文档 _id也可以直接指定，但如果数据库中此集合下已经有此_id的话插入会失败</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nInserted&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="save">save</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nb">document</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>参数</strong></p>
<ul>
<li>collection_name 集合的名字</li>
<li>document 插入的文档</li>
</ul>
<blockquote>
<p>注：如果不指定 _id 字段 save() 方法类似于 insert() 方法。如果指定 _id 字段，则会更新该 _id 的数据。</p>
</blockquote>
<p>实例</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">})</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">100</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="更新文档">更新文档</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">db.collection.update(
   &lt;query&gt;,
   &lt;updateObj&gt;,
   {
     upsert: &lt;boolean&gt;,
     multi: &lt;boolean&gt;
   }
)
</code></pre></td></tr></table>
</div>
</div><p><strong>参数说明</strong></p>
<ul>
<li>query 查询条件,指定要更新符合哪些条件的文档</li>
<li>updateObj 更新后的对象或指定一些更新的操作符
<ul>
<li>$set 直接指定更新后的值</li>
<li>$inc 在原基础上累加</li>
<li>$unset 删除指定的键</li>
<li>$push 向数组中添加元素</li>
</ul>
</li>
<li>upsert 可选，这个参数的意思是，如果不存在符合条件的记录时是否插入updateObj. 默认是false,不插入。</li>
<li>multi 可选，mongodb 默认只更新找到的第一条记录，如果这个参数为true,就更新所有符合条件的记录。
实例 将students集合中数据中name是luke2的值修改为luke22</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke2&#39;</span><span class="p">},{</span><span class="nx">age</span><span class="o">:</span><span class="mi">300</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>注：如果有多条name是luke2的数据只更新一条,如果想全部更新需要指定{multi:true}的参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke2&#39;</span><span class="p">},{</span><span class="nx">$set</span><span class="o">:</span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="mi">300</span><span class="p">}},{</span><span class="nx">multi</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="runcommand">runCommand</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"> <span class="kd">var</span> <span class="nx">modify</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">findAndModify</span><span class="o">:</span><span class="s1">&#39;student&#39;</span><span class="p">,</span>
    <span class="nx">query</span><span class="o">:</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">},</span>
    <span class="nx">update</span><span class="o">:</span><span class="p">{</span><span class="nx">$set</span><span class="o">:</span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="mi">100</span><span class="p">}},</span>
    <span class="nx">fields</span><span class="o">:</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;1&#39;</span><span class="p">},</span>
    <span class="nx">sort</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
    <span class="k">new</span><span class="o">:</span><span class="kc">true</span> <span class="c1">//返回修改后的值
</span><span class="c1"></span><span class="p">}</span>

<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span><span class="nx">modify</span><span class="p">);</span>
<span class="nx">printjson</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="文档的删除">文档的删除</h4>
<p><strong>remove</strong>方法是用来移除集合中的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span>
   <span class="o">&lt;</span><span class="nx">query</span><span class="o">&gt;</span><span class="p">,</span>
   <span class="p">{</span>
     <span class="nx">justOne</span><span class="o">:</span> <span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span>
   <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>参数说明</p>
<ul>
<li>query :（可选）删除的文档的条件。</li>
<li>justOne : （可选）如果设为 true 或 1，则只删除匹配到的多个文档中的第一个</li>
</ul>
<p>实例 删除worker集合里name是luke2的所有文档数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">remove</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke2&#39;</span><span class="p">});</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nRemoved&#34;</span> <span class="o">:</span> <span class="mi">2</span> <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>即使匹配多条也只删除一条</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">remove</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;luke2&#34;</span><span class="p">},{</span><span class="nx">justOne</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nRemoved&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="查询文档">查询文档</h4>
<h4 id="find">find</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>参数</strong></p>
<ul>
<li>collection_name 集合的名字</li>
</ul>
<p>查询students下所有的文档</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="查询指定列">查询指定列</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">queryWhere</span><span class="p">},{</span><span class="nx">key</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">key</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>参数</strong></p>
<ul>
<li>collection_name 集合的名字</li>
<li>queryWhere 参阅查询条件操作符</li>
<li>key 指定要返回的列</li>
<li>1 表示要显示</li>
</ul>
<p>只返回显示age列</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({},{</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="findone">findOne</h4>
<p>查询匹配结果的第一条数据 语法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">findOne</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>实例</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">findOne</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="in">$in</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="p">{</span><span class="nx">$in</span><span class="o">:</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">]}},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="nin">$nin</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="p">{</span><span class="nx">$nin</span><span class="o">:</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">]}},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="nin-1">$nin</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="p">{</span><span class="nx">$in</span><span class="o">:</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">]}},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="not">$not</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="p">{</span><span class="nx">$not</span><span class="o">:</span><span class="p">{</span><span class="nx">$gte</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">$lte</span><span class="o">:</span><span class="mi">30</span><span class="p">}}});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="array">array</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//按所有元素匹配
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">[</span> <span class="s2">&#34;Lufy&#34;</span><span class="p">,</span> <span class="s2">&#34;Nami2&#34;</span><span class="p">,</span> <span class="s2">&#34;Wusopu&#34;</span><span class="p">,</span> <span class="s2">&#34;A&#34;</span> <span class="p">]});</span>
<span class="c1">//匹配一条
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="s2">&#34;A&#34;</span><span class="p">});</span>
<span class="c1">//$all
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$all</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s2">&#34;Lufy&#34;</span><span class="p">]}});</span>
<span class="c1">//$in
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$in</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s2">&#34;Lufy&#34;</span><span class="p">]}});</span>
<span class="c1">//$size
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$size</span><span class="o">:</span><span class="mi">4</span><span class="p">}});</span>
<span class="c1">//$slice
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$size</span><span class="o">:</span><span class="mi">5</span><span class="p">}},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$slice</span><span class="o">:</span><span class="mi">1</span><span class="p">}});</span>
<span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$size</span><span class="o">:</span><span class="mi">5</span><span class="p">}},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">friends</span><span class="o">:</span><span class="p">{</span><span class="nx">$slice</span><span class="o">:-</span><span class="mi">1</span><span class="p">}});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="where">where</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">$where</span><span class="o">:</span><span class="s2">&#34;this.age&gt;30&#34;</span><span class="p">},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="cursor">cursor</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">student</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>

<span class="c1">//while(result.hasNext()){
</span><span class="c1">//    printjson(result.next());
</span><span class="c1">//}
</span><span class="c1"></span>
<span class="nx">result</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">element</span><span class="p">=&gt;</span><span class="nx">printjson</span><span class="p">(</span><span class="nx">element</span><span class="p">));</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="条件操作符">条件操作符</h3>
<p>条件操作符用于比较两个表达式并从mongoDB集合中获取数据</p>
<h4 id="大于操作符">大于操作符</h4>
<p>查询age 大于 30的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="p">{</span><span class="nx">$gt</span><span class="o">:</span><span class="mi">30</span><span class="p">}})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="大于等于操作符">大于等于操作符</h4>
<p>查询age 3大于等于30 的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mi">30</span><span class="p">}})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="小于操作符">小于操作符</h4>
<p>查询age 小于30的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">30</span><span class="p">}})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="小于等于操作符">小于等于操作符</h4>
<p>查询age 小于等于30的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lte</span><span class="o">:</span> <span class="mi">30</span><span class="p">}})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="同时使用-gte和lte">同时使用 <code>$gte</code>和<code>$lte</code></h4>
<p>实例 查询age 大于等于 30 并且 age 小于等于 50 的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span> <span class="nx">$lte</span><span class="o">:</span> <span class="mi">50</span><span class="p">}})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="等于">等于</h4>
<p>查询age = 30的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&#34;age&#34;</span><span class="o">:</span> <span class="mi">30</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="使用-_id进行查询">使用 _id进行查询</h4>
<p>实例 查询_id是 562af23062d5a57609133974 数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span><span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5adb666ecd738e9771638985&#34;</span><span class="p">)});</span>
<span class="p">{</span> <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5adb666ecd738e9771638985&#34;</span><span class="p">),</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;zzzz&#34;</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="查询结果集的条数">查询结果集的条数</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">count</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="正则匹配">正则匹配</h4>
<p>实例 查询name里包含luke的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="sr">/luke/</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>查询某个字段的值当中是否以另一个值开头</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="sr">/^luke/</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>###与和或</p>
<h4 id="and">and</h4>
<p>find方法可以传入多个键(key)，每个键(key)以逗号隔开</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">key1</span><span class="o">:</span><span class="nx">value1</span><span class="p">,</span> <span class="nx">key2</span><span class="o">:</span><span class="nx">value2</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>实例 查询name是luke并且age是1的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="or">or</h4>
<p>语法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
   <span class="p">{</span>
      <span class="nx">$or</span><span class="o">:</span> <span class="p">[</span>
   <span class="p">{</span><span class="nx">key1</span><span class="o">:</span> <span class="nx">value1</span><span class="p">},</span> <span class="p">{</span><span class="nx">key2</span><span class="o">:</span><span class="nx">value2</span><span class="p">}</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>实例 查询age = 30 或者 age = 50 的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">$or</span><span class="o">:</span><span class="p">[{</span><span class="nx">age</span><span class="o">:</span><span class="mi">30</span><span class="p">},{</span><span class="nx">age</span><span class="o">:</span><span class="mi">50</span><span class="p">}]})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="and和or联用">and和or联用</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collection_name</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
   <span class="p">{</span>
     <span class="nx">key1</span><span class="o">:</span><span class="nx">value1</span><span class="p">,</span>
     <span class="nx">key2</span><span class="o">:</span><span class="nx">value2</span><span class="p">,</span>
     <span class="nx">$or</span><span class="o">:</span> <span class="p">[</span>
   <span class="p">{</span><span class="nx">key1</span><span class="o">:</span> <span class="nx">value1</span><span class="p">},</span>
   <span class="p">{</span><span class="nx">key2</span><span class="o">:</span><span class="nx">value2</span><span class="p">}</span>
     <span class="p">]</span>
   <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>实例 查询 name是luke 并且 age是30 或者 age是 50 的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;luke&#39;</span><span class="p">,</span><span class="nx">$or</span><span class="o">:</span><span class="p">[{</span><span class="nx">age</span><span class="o">:</span><span class="mi">30</span><span class="p">},{</span><span class="nx">age</span><span class="o">:</span><span class="mi">50</span><span class="p">}]})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="分页查询">分页查询</h3>
<h4 id="limit">limit</h4>
<p>读取指定数量的数据记录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collectoin_name</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">limit</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>参数</p>
<p>collectoin_name集合
number读取的条数
实例 查询前3条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">limit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="skip">skip</h4>
<p>跳过指定数量的数据，skip方法同样接受一个数字参数作为跳过的记录条数 语法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collectoin_name</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">skip</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>参数</p>
<p>collectoin_name集合
number跳过的条数
实例 查询3条以后的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">skip</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="skiplimit">skip+limit</h4>
<p>通常用这种方式来实现分页功能 语法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collectoin_name</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">skip</span><span class="p">(</span><span class="nx">skipNum</span><span class="p">).</span><span class="nx">limit</span><span class="p">(</span><span class="nx">limitNum</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>参数</p>
<p>collectoin_name 集合名称
skipNum 跳过的条数
limitNum 限制返回的条数
实例 查询在4-6之间的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">skip</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="sort排序">sort排序</h4>
<p>sort()方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而-1是用于降序排列。 语法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">collectoin_name</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">sort</span><span class="p">({</span><span class="nx">key</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">collectoin_name</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">sort</span><span class="p">({</span><span class="nx">key</span><span class="o">:-</span><span class="mi">1</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>参数</p>
<p>collectoin_name集合
key表示字段
实例 查询出并升序排序 {age:1} age表示按那个字段排序 1表示升序</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">sort</span><span class="p">({</span><span class="nx">age</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div>
        </div>
        <div class ='post_extra mb-2'>
          <div class = 'copy'></div>

        </div>
        <div>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "ytop" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      </div>
    </div>
  </div>
  <a href = 'http://www.ytop.net' class = 'post_nav'><span class = 'post_next'>The Latest</span>T</a>

    </main>
    <footer class = 'footer wrap pale'>
  <p style="vertical-align:middle;"><a style="color: black;" href = 'http://beian.miit.gov.cn'>鄂ICP备20003010号-1</a>&nbsp;&nbsp;<img style="padding:0;margin:0;vertical-align:middle;display:inline-block;float: none;" src="https://img-1256541035.cos.ap-shanghai.myqcloud.com/imgs/beiantubiao.png"/><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42090202000341" style="color: black;" >&nbsp;鄂公网安备 42090202000341号</a></p>
  <p>&copy;&nbsp;<span class = 'year'></span>&nbsp;Luke&#39;s blog</p>
</footer>


<script src = 'http://www.ytop.net/js/index.min.608c49e9f95a010225bca8d37be2d76e24aedbf4ecb8d97780a297c2d844bebcde5c0beea5d0ad0935f1ea2bc6e06a78451deb0fdc08298f4e5ffc45cf1772aa.js'></script>

  </body>
</html>
