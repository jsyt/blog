<!DOCTYPE html>
<html lang='en'>
  <head>
  <title>Webpack 工作原理（一）——配置篇 | Luke&#39;s blog</title>
  <meta charset='utf-8'>
  <meta name = 'viewport' content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'>
  <meta http-equiv = 'X-UA-Compatible' content = 'IE=edge'>
  <meta name = 'SKYPE_TOOLBAR' content = 'SKYPE_TOOLBAR_PARSER_COMPATIBLE' /><meta name = 'keywords' content = 'Luke&#39;s blog'>
<meta property = 'og:locale' content = 'en_US' />
<meta property = 'og:type' content = 'article' />
<meta property = 'og:title' content = 'Webpack 工作原理（一）——配置篇' />
<meta property = 'og:description' content = 'WebPack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。构建就是把源代码转换成发布到线上的可执行 JavaScrip、CSS、HTML 代码， …'>
<meta property = 'og:url' content = 'https://www.goyth.cn/post/webpackconfig/' />
<meta property = 'og:image' content = 'images/%!s()'/>
<link rel='apple-touch-icon' sizes='180x180' href='https://www.goyth.cn/images/icons/apple-touch-icon.png'>
<link rel='icon' type='image/png' sizes='32x32' href='https://www.goyth.cn/images/icons/favicon-32x32.png'>
<link rel='icon' type='image/png' sizes='16x16' href='https://www.goyth.cn/images/icons/favicon-16x16.png'>
<link rel='manifest' href='https://www.goyth.cn/images/icons/site.webmanifest'>
<meta name='msapplication-TileColor' content='#da532c'>
<meta name='theme-color' content='#ffffff'>

  <link rel='canonical' href='https://www.goyth.cn/post/webpackconfig/'>
  <link rel = 'stylesheet' href = 'https://www.goyth.cn/css/main.065565dac51feed0921255d53f111780fd4d0fc4ed28ef2522e9607ed0c03e3e7dd5c06f5fc3d775557a4922f93c743fc68b786af93e19a746e7f02edd066fac.css' integrity = 'sha512-BlVl2sUf7tCSElXVPxEXgP1ND8TtKO8lIulgftDAPj591cBvX8PXdVV6SSL5PHQ/xot4avk&#43;GadG5/Au3QZvrA=='>
</head>

  <body>
    <div class = 'nav-drop'>
  <div class = 'nav-body'>
    
      <a href = 'https://www.goyth.cn' class = 'nav_item'>Home</a>
    
      <a href = 'https://www.goyth.cn/categories' class = 'nav_item'>Category</a>
    
      <a href = 'https://www.goyth.cn/tags' class = 'nav_item'>Tag</a>
    
      <a href = 'https://www.goyth.cn/about/' class = 'nav_item'>About</a>
    
    <div class = 'nav-close'></div>
    <div class = 'color_mode'>
<label for = 'mode'>Toggle Dark Mode</label>
<input type = 'checkbox' class = 'color_choice' id = 'mode'>
</div>

  </div>
</div>
<header class = 'nav' >
  <nav class = 'nav-menu'>
    <a href='https://www.goyth.cn' class = 'nav-brand nav_item'>Luke&#39;s blog</a>
    <div class = 'nav_bar-wrap'>
      <div class = 'nav_bar'></div>
    </div>
  </nav>
</header>


    <main>
      
  <div class = 'wrap mt post'>
    <div><p class = 'post_date pale'>17. November 2018</p>
      <h1 class = 'post_title'>Webpack 工作原理（一）——配置篇</h1>
      <div class = 'post_body'>
        <div class = 'post_inner'>
        
        
          <h3 id="什么是webpack">什么是WebPack</h3>
<p>WebPack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。</p>
<p>构建就是把源代码转换成发布到线上的可执行 JavaScrip、CSS、HTML 代码，包括如下内容。</p>
<ul>
<li><strong>代码转换</strong>：TypeScript 编译成 JavaScript、SCSS 编译成 CSS 等。</li>
<li><strong>文件优化</strong>：压缩 JavaScript、CSS、HTML 代码，压缩合并图片等。</li>
<li><strong>代码分割</strong>：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li>
<li><strong>模块合并</strong>：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li>
<li><strong>自动刷新</strong>：监听本地源代码的变化，自动重新构建、刷新浏览器。</li>
<li><strong>代码校验</strong>：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li>
<li><strong>自动发布</strong>：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li>
</ul>
<p>构建其实是工程化、自动化思想在前端开发中的体现，把一系列流程用代码去实现，让代码自动化地执行这一系列复杂的流程。 构建给前端开发注入了更大的活力，解放了我们的生产力。</p>
<h3 id="webpack核心概念">webpack核心概念</h3>
<ul>
<li><strong>Entry</strong>：入口，Webpack 执行构建的第一步将从 Entry 开始，可抽象成输入。</li>
<li><strong>Module</strong>：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</li>
<li><strong>Chunk</strong>：代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</li>
<li><strong>Loader</strong>：模块转换器，用于把模块原内容按照需求转换成新内容。</li>
<li><strong>Plugin</strong>：扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li>
<li><strong>Output</strong>：输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果。</li>
</ul>
<h3 id="webpack基本配置">webpack基本配置</h3>
<h4 id="安装webpack">安装webpack</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">webpack</span> <span class="nx">webpack</span><span class="o">-</span><span class="nx">cli</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建src目录">创建src目录</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">mkdir</span> <span class="nx">src</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建dist目录">创建dist目录</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">mkdir</span> <span class="nx">dist</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建-webpackconfigjs-配置文件">创建 webpack.config.js 配置文件</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">touch</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">js</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="webpackconfigjs基本配置">webpack.config.js基本配置</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">path</span><span class="o">=</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="o">=</span><span class="p">{</span>
    <span class="nx">entry</span><span class="o">:</span> <span class="s1">&#39;./src/index.js&#39;</span><span class="p">,</span>
    <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;dist&#39;</span><span class="p">),</span>
        <span class="nx">filename</span><span class="o">:</span><span class="s1">&#39;bundle.js&#39;</span>
    <span class="p">},</span>
    <span class="nx">module</span><span class="o">:</span> <span class="p">{},</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">devServer</span><span class="o">:</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>entry：配置入口文件的地址</li>
<li>output：配置出口文件的地址</li>
<li>module：配置模块,主要用来配置不同文件的加载器</li>
<li>plugins：配置插件</li>
<li>devServer：配置开发服务器</li>
</ul>
<h4 id="创建indexhtml文件">创建index.html文件</h4>
<p>在dist目录下创建index.html文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;ie=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;bundle.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="webpack-详细配置">webpack 详细配置</h3>
<h4 id="配置开发服务器">配置开发服务器</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">webpack</span><span class="o">-</span><span class="nx">dev</span><span class="o">-</span><span class="nx">server</span> <span class="err">–</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"> <span class="nx">devServer</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">contentBase</span><span class="o">:</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;dist&#39;</span><span class="p">),</span>
        <span class="nx">host</span><span class="o">:</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
        <span class="nx">compress</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="nx">port</span><span class="o">:</span><span class="mi">8080</span>
 <span class="p">}</span>
  <span class="s2">&#34;scripts&#34;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&#34;build&#34;</span><span class="o">:</span> <span class="s2">&#34;webpack --mode development&#34;</span><span class="p">,</span>
    <span class="s2">&#34;dev&#34;</span><span class="o">:</span> <span class="s2">&#34;webpack-dev-server --open --mode development &#34;</span>
  <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>contentBase 配置开发服务运行时的文件根目录</li>
<li>host：开发服务器监听的主机地址</li>
<li>compress 开发服务器是否启动gzip等压缩</li>
<li>port：开发服务器监听的端口</li>
</ul>
<h4 id="什么是loader">什么是Loader</h4>
<p>通过使用不同的Loader，Webpack可以要把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等</p>
<ul>
<li>test：匹配处理文件的扩展名的正则表达式</li>
<li>use：loader名称，就是你要使用模块的名称</li>
<li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li>
<li>query：为loaders提供额外的设置选项</li>
</ul>
<h5 id="loader三种写法">loader三种写法</h5>
<p><strong>支持加载css文件</strong>
加载CSS文件，CSS文件有可能在node_modules里，比如bootstrap和antd
<strong>1. loader</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css/</span><span class="p">,</span>
                <span class="nx">loader</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;style-loader&#39;</span><span class="p">,</span><span class="s1">&#39;css-loader&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p><strong>2. use</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css/</span><span class="p">,</span>
                <span class="nx">use</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;style-loader&#39;</span><span class="p">,</span><span class="s1">&#39;css-loader&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>

</code></pre></td></tr></table>
</div>
</div><p><strong>3. use+loader</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js">  <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
              <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css/</span><span class="p">,</span>
              <span class="nx">include</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">),</span>
              <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
              <span class="nx">use</span><span class="o">:</span> <span class="p">[{</span>
                  <span class="nx">loader</span><span class="o">:</span> <span class="s1">&#39;style-loader&#39;</span><span class="p">,</span>
                  <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                      <span class="nx">insertAt</span><span class="o">:</span><span class="s1">&#39;top&#39;</span>
                  <span class="p">}</span>
              <span class="p">},</span><span class="s1">&#39;css-loader&#39;</span><span class="p">]</span>
          <span class="p">}</span>
      <span class="p">]</span>
  <span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="插件">插件</h4>
<p>在 webpack 的构建流程中，plugin 用于处理更多其他的一些构建任务
模块代码转换的工作由 loader 来处理
除此之外的其他任何工作都可以交由 plugin 来完成</p>
<h4 id="自动产出html">自动产出html</h4>
<p>我们希望自动能产出HTML文件，并在里面引入产出后的资源</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">html</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span> <span class="o">-</span><span class="nx">D</span>

</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js">    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">HtmlWebpackPlugin</span><span class="p">({</span>
         <span class="nx">minify</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">removeAttributeQuotes</span><span class="o">:</span><span class="kc">true</span>
        <span class="p">},</span>
        <span class="nx">hash</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;./src/index.html&#39;</span><span class="p">,</span>
        <span class="nx">filename</span><span class="o">:</span><span class="s1">&#39;index.html&#39;</span>
    <span class="p">})]</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>minify 是对html文件进行压缩，removeAttrubuteQuotes是去掉属性的双引号</li>
<li>hash 引入产出资源的时候加上查询参数，值为哈希避免缓存</li>
<li>template 模版路径</li>
</ul>
<h4 id="支持图片">支持图片</h4>
<h5 id="手动添加图片">手动添加图片</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">file</span><span class="o">-</span><span class="nx">loader</span> <span class="nx">url</span><span class="o">-</span><span class="nx">loader</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>file-loader 解决CSS等文件中的引入图片路径问题</li>
<li>url-loader 当图片小于limit的时候会把图片BASE64编码，大于limit参数的时候还是使用file-loader 进行拷贝</li>
</ul>
<h5 id="js中引入图片">JS中引入图片</h5>
<p><strong>JS</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">logo</span><span class="o">=</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./images/logo.png&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">img</span><span class="o">=</span><span class="k">new</span> <span class="nx">Image</span><span class="p">();</span>
<span class="nx">img</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="nx">logo</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nx">test</span><span class="o">:</span><span class="sr">/\.(jpg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span><span class="p">,</span>
    <span class="nx">use</span><span class="o">:</span><span class="p">[</span>
    <span class="p">{</span>
       <span class="nx">loader</span><span class="o">:</span><span class="s1">&#39;url-loader&#39;</span><span class="p">,</span>
       <span class="nx">options</span><span class="o">:</span><span class="p">{</span><span class="nx">limit</span><span class="o">:</span><span class="mi">4096</span><span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="在css中引入图片">在CSS中引入图片</h5>
<p>还可以在CSS文件中引入图片</p>
<p><strong>CSS</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">.</span><span class="nx">logo</span><span class="p">{</span>
    <span class="nx">width</span><span class="o">:</span><span class="mi">355</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">height</span><span class="o">:</span><span class="mi">133</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">background</span><span class="o">-</span><span class="nx">image</span><span class="o">:</span> <span class="nx">url</span><span class="p">(.</span><span class="o">/</span><span class="nx">images</span><span class="o">/</span><span class="nx">logo</span><span class="p">.</span><span class="nx">png</span><span class="p">);</span>
    <span class="nx">background</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="nx">cover</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>HTML</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&#34;logo&#34;</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>分离CSS</strong>
因为CSS的下载和JS可以并行,当一个HTML文件很大的时候，我们可以把CSS单独提取出来加载</p>
<ul>
<li>mini-css-extract-plugin</li>
<li>filename 打包入口文件</li>
<li>chunkFilename 用来打包import(&lsquo;module&rsquo;)方法中引入的模块</li>
</ul>
<p>安装依赖模块</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span><span class="o">-</span><span class="nx">dev</span> <span class="nx">mini</span><span class="o">-</span><span class="nx">css</span><span class="o">-</span><span class="nx">extract</span><span class="o">-</span><span class="nx">plugin</span>
</code></pre></td></tr></table>
</div>
</div><p>配置webpack.config.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
       <span class="c1">//参数类似于webpackOptions.output
</span><span class="c1"></span>        <span class="k">new</span> <span class="nx">MiniCssExtractPlugin</span><span class="p">({</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;[name].css&#39;</span><span class="p">,</span>
            <span class="nx">chunkFilename</span><span class="o">:</span><span class="s1">&#39;[id].css&#39;</span>
        <span class="p">})]</span>
<span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.css/</span><span class="p">,</span>
        <span class="nx">include</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">),</span>
        <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
        <span class="nx">use</span><span class="o">:</span> <span class="p">[{</span>
            <span class="nx">loader</span><span class="o">:</span> <span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span>
        <span class="p">},</span><span class="s1">&#39;css-loader&#39;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="压缩js和css">压缩JS和CSS</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">uglifyjs</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span> <span class="nx">optimize</span><span class="o">-</span><span class="nx">css</span><span class="o">-</span><span class="nx">assets</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">UglifyJsPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;uglifyjs-webpack-plugin&#34;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">OptimizeCSSAssetsPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;optimize-css-assets-webpack-plugin&#34;</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">mode</span><span class="o">:</span> <span class="s1">&#39;development&#39;</span><span class="p">,</span>
    <span class="nx">optimization</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">minimizer</span><span class="o">:</span> <span class="p">[</span>
            <span class="k">new</span> <span class="nx">UglifyJsPlugin</span><span class="p">({</span>
                <span class="nx">cache</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//启动缓存
</span><span class="c1"></span>                <span class="nx">parallel</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//启动并行压缩
</span><span class="c1"></span>                <span class="c1">//如果为true的话，可以获得sourcemap
</span><span class="c1"></span>                <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// set to true if you want JS source maps
</span><span class="c1"></span>            <span class="p">}),</span>
            <span class="c1">//压缩css资源的
</span><span class="c1"></span>            <span class="k">new</span> <span class="nx">OptimizeCSSAssetsPlugin</span><span class="p">({})</span>
        <span class="p">]</span>
    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="css和image存放单独目录">css和image存放单独目录</h5>
<ul>
<li>outputPath 输出路径</li>
<li>publicPath指定的是构建后在html里的路径</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;dist&#39;</span><span class="p">),</span>
        <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;bundle.js&#39;</span><span class="p">,</span>
        <span class="nx">publicPath</span><span class="o">:</span><span class="s1">&#39;/&#39;</span>
    <span class="p">},</span>
<span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nx">test</span><span class="o">:</span><span class="sr">/\.(jpg|jpeg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span><span class="p">,</span>
      <span class="nx">use</span><span class="o">:</span><span class="p">[</span>
            <span class="p">{</span>
              <span class="nx">loader</span><span class="o">:</span><span class="s1">&#39;url-loader&#39;</span><span class="p">,</span>
              <span class="nx">options</span><span class="o">:</span><span class="p">{</span>
                  <span class="nx">limit</span><span class="o">:</span> <span class="mi">4096</span><span class="p">,</span>
                  <span class="nx">outputPath</span><span class="o">:</span> <span class="s1">&#39;images&#39;</span><span class="p">,</span>
                  <span class="nx">publicPath</span><span class="o">:</span><span class="s1">&#39;/images&#39;</span>
              <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">},</span>
<span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">MiniCssExtractPlugin</span><span class="p">({</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;css/[name].css&#39;</span><span class="p">,</span>
            <span class="nx">chunkFilename</span><span class="o">:</span><span class="s1">&#39;css/[id].css&#39;</span>
        <span class="p">})]</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="在html中使用图片">在HTML中使用图片</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">html</span><span class="o">-</span><span class="nx">withimg</span><span class="o">-</span><span class="nx">loader</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><p>index.html</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;./images/logo.png&#34;</span><span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>webpack.config.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.(html|htm)$/</span><span class="p">,</span>
  <span class="nx">use</span><span class="o">:</span> <span class="s1">&#39;html-withimg-loader&#39;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="编译less-和-sass">编译less 和 sass</h4>
<h5 id="安装less">安装less</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">less</span> <span class="nx">less</span><span class="o">-</span><span class="nx">loader</span> <span class="o">-</span><span class="nx">D</span>
<span class="nx">npm</span> <span class="nx">i</span> <span class="nx">node</span><span class="o">-</span><span class="nx">sass</span> <span class="nx">sass</span><span class="o">-</span><span class="nx">loader</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="编写样式">编写样式</h5>
<p>less</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="p">@</span><span class="k">color</span><span class="p">:</span><span class="nd">orange</span><span class="p">;</span>
<span class="p">.</span><span class="nc">less-container</span><span class="p">{</span>
    <span class="k">color</span><span class="p">:</span><span class="o">@</span><span class="kc">color</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>sass</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="o">$</span><span class="nt">color</span><span class="p">:</span><span class="nd">green</span><span class="o">;</span>
<span class="p">.</span><span class="nc">sass-container</span><span class="p">{</span>
    <span class="k">color</span><span class="p">:</span><span class="kc">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.less/</span><span class="p">,</span>
    <span class="nx">include</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">),</span>
    <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
    <span class="nx">use</span><span class="o">:</span> <span class="p">[{</span>
        <span class="nx">loader</span><span class="o">:</span> <span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
    <span class="p">},</span><span class="s1">&#39;css-loader&#39;</span><span class="p">,</span><span class="s1">&#39;less-loader&#39;</span><span class="p">]</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.scss/</span><span class="p">,</span>
    <span class="nx">include</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">),</span>
    <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
    <span class="nx">use</span><span class="o">:</span> <span class="p">[{</span>
        <span class="nx">loader</span><span class="o">:</span> <span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span>
    <span class="p">},</span><span class="s1">&#39;css-loader&#39;</span><span class="p">,</span><span class="s1">&#39;sass-loader&#39;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="处理css3属性前缀">处理CSS3属性前缀</h4>
<p>为了浏览器的兼容性，有时候我们必须加入-webkit,-ms,-o,-moz这些前缀</p>
<ul>
<li>Trident内核：主要代表为IE浏览器, 前缀为-ms</li>
<li>Gecko内核：主要代表为Firefox, 前缀为-moz</li>
<li>Presto内核：主要代表为Opera, 前缀为-o</li>
<li>Webkit内核：产要代表为Chrome和Safari, 前缀为 <strong>-webkit</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">postcss</span><span class="o">-</span><span class="nx">loader</span> <span class="nx">autoprefixer</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>index.css</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="p">::</span><span class="nd">placeholder</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>postcss.config.js</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="o">=</span><span class="p">{</span>
    <span class="nx">plugins</span><span class="o">:</span><span class="p">[</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;autoprefixer&#39;</span><span class="p">)]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>webpack.config.js</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
   <span class="nx">test</span><span class="o">:</span><span class="sr">/\.css$/</span><span class="p">,</span>
   <span class="nx">use</span><span class="o">:</span><span class="p">[</span><span class="nx">MiniCssExtractPlugin</span><span class="p">.</span><span class="nx">loader</span><span class="p">,</span><span class="s1">&#39;css-loader&#39;</span><span class="p">,</span><span class="s1">&#39;postcss-loader&#39;</span><span class="p">],</span>
   <span class="nx">include</span><span class="o">:</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;./src&#39;</span><span class="p">),</span>
   <span class="nx">exclude</span><span class="o">:</span><span class="sr">/node_modules/</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="转义es6es7jsx">转义ES6/ES7/JSX</h4>
<p><strong>Babel</strong>其实是一个编译JavaScript的平台,可以把ES6/ES7,React的JSX转义为ES5</p>
<h4 id="babel-plugin-proposal-decorator">babel-plugin-proposal-decorator</h4>
<p><strong>安装依赖包</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">babel</span><span class="o">-</span><span class="nx">loader</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">core</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">preset</span><span class="o">-</span><span class="nx">env</span>  <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">preset</span><span class="o">-</span><span class="nx">react</span>  <span class="o">-</span><span class="nx">D</span>
<span class="nx">npm</span> <span class="nx">i</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">plugin</span><span class="o">-</span><span class="nx">proposal</span><span class="o">-</span><span class="nx">decorators</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">plugin</span><span class="o">-</span><span class="nx">proposal</span><span class="o">-</span><span class="kr">class</span><span class="o">-</span><span class="nx">properties</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="decorator">decorator</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//Option+Shift+A
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">readonly</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="nx">key</span><span class="p">,</span><span class="nx">discriptor</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">discriptor</span><span class="p">.</span><span class="nx">writable</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Person</span><span class="p">{</span>
    <span class="err">@</span><span class="nx">readonly</span> <span class="nx">PI</span><span class="o">=</span><span class="mf">3.14</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">p1</span><span class="o">=</span><span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
<span class="nx">p1</span><span class="p">.</span><span class="nx">PI</span><span class="o">=</span><span class="mf">3.15</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>jsconfig.json</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="s2">&#34;compilerOptions&#34;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&#34;experimentalDecorators&#34;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="webpackconfigjs">webpack.config.js</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.jsx?$/</span><span class="p">,</span>
    <span class="nx">use</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">loader</span><span class="o">:</span> <span class="s1">&#39;babel-loader&#39;</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span><span class="p">{</span>
         <span class="s2">&#34;plugins&#34;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&#34;@babel/plugin-proposal-decorators&#34;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&#34;legacy&#34;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}],</span>
            <span class="p">[</span><span class="s2">&#34;@babel/plugin-proposal-class-properties&#34;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&#34;loose&#34;</span> <span class="o">:</span> <span class="kc">true</span> <span class="p">}]</span>
         <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">include</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">),</span>
    <span class="nx">exclude</span><span class="o">:</span><span class="sr">/node_modules/</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="babel-runtime">babel runtime</h5>
<p><strong>babel</strong> 在每个文件都插入了辅助代码，使代码体积过大
babel 对一些公共方法使用了非常小的辅助代码，比如 <strong>_extend</strong>
默认情况下会被添加到每一个需要它的文件中。你可以引入 <strong>@babel/runtime</strong> 作为一个独立模块，来避免重复引入
<strong>babel-plugin-transform-runtime</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span><span class="o">-</span><span class="nx">dev</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">plugin</span><span class="o">-</span><span class="nx">transform</span><span class="o">-</span><span class="nx">runtime</span>
<span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">runtime</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>.babelrc</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="s2">&#34;presets&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;@babel/preset-env&#34;</span><span class="p">],</span>
  <span class="s2">&#34;plugins&#34;</span><span class="o">:</span> <span class="p">[</span>
   <span class="p">[</span>
         <span class="s2">&#34;@babel/plugin-transform-runtime&#34;</span><span class="p">,</span>
         <span class="p">{</span>
            <span class="s2">&#34;corejs&#34;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="s2">&#34;helpers&#34;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="s2">&#34;regenerator&#34;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="s2">&#34;useESModules&#34;</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>webpack打包的时候，会自动优化重复引入公共方法的问题</p>
<h4 id="eslint校验代码格式规范">ESLint校验代码格式规范</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">eslint</span> <span class="nx">eslint</span><span class="o">-</span><span class="nx">loader</span> <span class="nx">babel</span><span class="o">-</span><span class="nx">eslint</span> <span class="o">--</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>.eslintrc.js</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">root</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="c1">//指定解析器选项
</span><span class="c1"></span>    <span class="nx">parserOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">sourceType</span><span class="o">:</span> <span class="s1">&#39;module&#39;</span>
    <span class="p">},</span>
    <span class="c1">//指定脚本的运行环境
</span><span class="c1"></span>    <span class="nx">env</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">browser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1">// 启用的规则及其各自的错误级别
</span><span class="c1"></span>    <span class="nx">rules</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&#34;indent&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;error&#34;</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span><span class="c1">//缩进风格
</span><span class="c1"></span>        <span class="s2">&#34;quotes&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;error&#34;</span><span class="p">,</span> <span class="s2">&#34;double&#34;</span><span class="p">],</span><span class="c1">//引号类型
</span><span class="c1"></span>        <span class="s2">&#34;semi&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;error&#34;</span><span class="p">,</span> <span class="s2">&#34;always&#34;</span><span class="p">],</span><span class="c1">//关闭语句强制分号结尾
</span><span class="c1"></span>        <span class="s2">&#34;no-console&#34;</span><span class="o">:</span> <span class="s2">&#34;error&#34;</span><span class="p">,</span><span class="c1">//禁止使用console
</span><span class="c1"></span>        <span class="s2">&#34;arrow-parens&#34;</span><span class="o">:</span> <span class="mi">0</span> <span class="c1">//箭头函数用小括号括起来
</span><span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">//配置加载规则
</span><span class="c1"></span>    <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span>
            <span class="nx">loader</span><span class="o">:</span> <span class="s1">&#39;eslint-loader&#39;</span><span class="p">,</span>
            <span class="nx">enforce</span><span class="o">:</span> <span class="s2">&#34;pre&#34;</span><span class="p">,</span>
            <span class="nx">include</span><span class="o">:</span> <span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">)],</span> <span class="c1">// 指定检查的目录
</span><span class="c1"></span>            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span> <span class="nx">fix</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="c1">// 这里的配置项参数将会被传递到 eslint 的 CLIEngine
</span><span class="c1"></span>        <span class="p">},</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="如何调试打包后的代码">如何调试打包后的代码</h4>
<p>webpack通过配置可以自动给我们source maps文件，map文件是一种对应编译文件和源文件的方法</p>
<ul>
<li><strong>source-map</strong>把映射文件生成到单独的文件，最完整最慢</li>
<li><strong>cheap-module-source-map</strong> 在一个单独的文件中产生一个不带列映射的Map</li>
<li><strong>eval-source-map</strong> 使用eval打包源文件模块,在同一个文件中生成完整sourcemap</li>
<li><strong>cheap-module-eval-source-map</strong> sourcemap和打包后的JS同行显示，没有映射列</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">devtool</span><span class="o">:</span><span class="s1">&#39;eval-source-map&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="打包第三方类库">打包第三方类库</h4>
<h5 id="直接引入">直接引入</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">_</span> <span class="nx">from</span> <span class="s1">&#39;lodash&#39;</span><span class="p">;</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">join</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="s1">&#39;@&#39;</span><span class="p">));</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="插件引入">插件引入</h5>
<ul>
<li>_ 函数会自动添加到当前模块的上下文，无需显示声明</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">ProvidePlugin</span><span class="p">({</span>
   <span class="nx">_</span><span class="o">:</span><span class="s1">&#39;lodash&#39;</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>没有全局的$函数，所以导入依赖全局变量的插件依旧会失败</p>
<h5 id="expose-loader">expose-loader</h5>
<p>不需要任何其他的插件配合，只要将下面的代码添加到所有的loader之前</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;expose-loader?libraryName!./file.js&#34;</span><span class="p">);</span>
<span class="p">{</span>
    <span class="nx">test</span><span class="o">:</span> <span class="nx">require</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">&#34;jquery&#34;</span><span class="p">),</span>
    <span class="nx">loader</span><span class="o">:</span> <span class="s2">&#34;expose-loader?jQuery&#34;</span>
<span class="p">}</span>
<span class="nx">require</span><span class="p">(</span><span class="s2">&#34;expose-loader?$!jquery&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="externals">externals</h5>
<p>如果我们想引用一个库，但是又不想让webpack打包，并且又不影响我们在程序中以CMD、AMD或者window/global全局等方式进行使用，那就可以通过配置externals</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">jQuery</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;jquery&#34;</span><span class="p">);</span>
<span class="kr">import</span> <span class="nx">jQuery</span> <span class="nx">from</span> <span class="s1">&#39;jquery&#39;</span><span class="p">;</span>
<span class="nx">externals</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">jquery</span><span class="o">:</span> <span class="s1">&#39;jQuery&#39;</span><span class="c1">//如果要在浏览器中运行，那么不用添加什么前缀，默认设置就是global
</span><span class="c1"></span><span class="p">},</span>
<span class="nx">module</span><span class="o">:</span> <span class="p">{}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="watch">watch</h4>
<p>当代码发生修改后可以自动重新编译</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">watch</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="nx">watchOptions</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">ignored</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span> <span class="c1">//忽略不用监听变更的目录
</span><span class="c1"></span>    <span class="nx">poll</span><span class="o">:</span><span class="mi">1000</span><span class="p">,</span> <span class="c1">//每秒询问的文件变更的次数
</span><span class="c1"></span>    <span class="nx">aggregateTimeout</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span> <span class="c1">//防止重复保存频繁重新编译,500毫秒内重复保存不打包
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>webpack定时获取文件的更新时间，并跟上次保存的时间进行比对，不一致就表示发生了变化,poll就用来配置每秒问多少次
当检测文件不再发生变化，会先缓存起来，等待一段时间后之后再通知监听者，这个等待时间通过aggregateTimeout配置
webpack只会监听entry依赖的文件
我们需要尽可能减少需要监听的文件数量和检查频率，当然频率的降低会导致灵敏度下降</p>
<h4 id="添加商标">添加商标</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">BannerPlugin</span><span class="p">(</span><span class="s1">&#39;Garmin&#39;</span><span class="p">),</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="拷贝静态文件">拷贝静态文件</h4>
<p>有时项目中没有引用的文件也需要打包到目标目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">copy</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span> <span class="o">-</span><span class="nx">D</span>
<span class="k">new</span> <span class="nx">CopyWebpackPlugin</span><span class="p">([{</span>
  <span class="nx">from</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;src/assets&#39;</span><span class="p">),</span><span class="c1">//静态资源目录源地址
</span><span class="c1"></span>  <span class="nx">to</span><span class="o">:</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;dist/assets&#39;</span><span class="p">)</span> <span class="c1">//目标地址，相对于output的path目录
</span><span class="c1"></span><span class="p">}])</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="打包前先清空输出目录">打包前先清空输出目录</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span>  <span class="nx">clean</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span> <span class="o">-</span><span class="nx">D</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">CleanWebpackPlugin</span><span class="p">([</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;dist&#39;</span><span class="p">)])</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="服务器代理">服务器代理</h4>
<p>如果你有单独的后端开发服务器 API，并且希望在同域名下发送 API 请求 ，那么代理某些 URL 会很有用。</p>
<h5 id="不修改路径">不修改路径</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//请求到 /api/users 现在会被代理到请求 http://localhost:3000/api/users。
</span><span class="c1"></span>
<span class="nx">proxy</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&#34;/api&#34;</span><span class="o">:</span> <span class="s1">&#39;http://localhost:3000&#39;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="修改路径">修改路径</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">proxy</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&#34;/api&#34;</span><span class="o">:</span> <span class="p">{</span>
       <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">,</span>
       <span class="nx">pathRewrite</span><span class="o">:</span><span class="p">{</span><span class="s2">&#34;^/api&#34;</span><span class="o">:</span><span class="s2">&#34;&#34;</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="before-after">before after</h4>
<p>before 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">before</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/users&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">([{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;zfpx1&#39;</span><span class="p">}])</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="webpack-dev-middleware">webpack-dev-middleware</h4>
<p>webpack-dev-middleware就是在 Express 中提供 webpack-dev-server 静态服务能力的一个中间件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">webpack</span><span class="o">-</span><span class="nx">dev</span><span class="o">-</span><span class="nx">middleware</span> <span class="o">--</span><span class="nx">save</span><span class="o">-</span><span class="nx">dev</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">webpackDevMiddleware</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-dev-middleware&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">webpackOptions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./webpack.config&#39;</span><span class="p">);</span>
<span class="nx">webpackOptions</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="s1">&#39;development&#39;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">compiler</span> <span class="o">=</span> <span class="nx">webpack</span><span class="p">(</span><span class="nx">webpackOptions</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">webpackDevMiddleware</span><span class="p">(</span><span class="nx">compiler</span><span class="p">,</span> <span class="p">{}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>webpack-dev-server 的好处是相对简单，直接安装依赖后执行命令即可
而使用webpack-dev-middleware的好处是可以在既有的 Express 代码基础上快速添加 webpack-dev-server 的功能，同时利用 Express 来根据需要添加更多的功能，如 mock 服务、代理 API 请求等</p>
<h3 id="resolve解析">resolve解析</h3>
<h4 id="extensions">extensions</h4>
<p>指定extension之后可以不用在require或是import的时候加文件扩展名,会依次尝试添加扩展名进行匹配</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">extensions</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;.js&#34;</span><span class="p">,</span><span class="s2">&#34;.jsx&#34;</span><span class="p">,</span><span class="s2">&#34;.json&#34;</span><span class="p">,</span><span class="s2">&#34;.css&#34;</span><span class="p">]</span>
<span class="p">},</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="alias">alias</h4>
<p>配置别名可以加快webpack查找模块的速度</p>
<p>每当引入bootstrap模块的时候，它会直接引入bootstrap,而不需要从node_modules文件夹中按模块的查找规则查找</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">bootstrap</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="s1">&#39;node_modules/_bootstrap@3.3.7@bootstrap/dist/css/bootstrap.css&#39;</span><span class="p">);</span>
<span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">alias</span><span class="o">:</span><span class="p">{</span>
      <span class="s2">&#34;bootstrap&#34;</span><span class="o">:</span><span class="nx">bootstrap</span>
  <span class="p">}</span>
<span class="p">},</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="modules">modules</h4>
<p>对于直接声明依赖名的模块（如 react ），webpack 会类似 Node.js 一样进行路径搜索，搜索node_modules目录
这个目录就是使用resolve.modules字段进行配置的 默认配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
<span class="nx">modules</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;node_modules&#39;</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>如果可以确定项目内所有的第三方依赖模块都是在项目根目录下的 node_modules 中的话</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
<span class="nx">modules</span><span class="o">:</span> <span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;node_modules&#39;</span><span class="p">)],</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="mainfields">mainFields</h4>
<p>默认情况下package.json 文件则按照文件中 main 字段的文件名来查找文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
  <span class="c1">// 配置 target === &#34;web&#34; 或者 target === &#34;webworker&#34; 时 mainFields 默认值是：
</span><span class="c1"></span>  <span class="nx">mainFields</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;browser&#39;</span><span class="p">,</span> <span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;main&#39;</span><span class="p">],</span>
  <span class="c1">// target 的值为其他时，mainFields 默认值为：
</span><span class="c1"></span>  <span class="nx">mainFields</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;module&#34;</span><span class="p">,</span> <span class="s2">&#34;main&#34;</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="mainfiles">mainFiles</h4>
<p>当目录下没有 package.json 文件时，我们说会默认使用目录下的 index.js 这个文件，其实这个也是可以配置的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">mainFiles</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="c1">// 你可以添加其他默认使用的文件名
</span><span class="c1"></span><span class="p">},</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="resolveloader">resolveLoader</h4>
<p>resolve.resolveLoader用于配置解析 loader 时的 resolve 配置,默认的配置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">resolveLoader</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">modules</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;node_modules&#39;</span> <span class="p">],</span>
    <span class="nx">extensions</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;.js&#39;</span><span class="p">,</span> <span class="s1">&#39;.json&#39;</span> <span class="p">],</span>
    <span class="nx">mainFields</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;loader&#39;</span><span class="p">,</span> <span class="s1">&#39;main&#39;</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="noparse">noParse</h4>
<p>module.noParse 字段，可以用于配置哪些模块文件的内容不需要进行解析
不需要解析依赖（即无依赖） 的第三方大型类库等，可以通过这个字段来配置，以提高整体的构建速度</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">// ...
</span><span class="c1"></span>  <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">noParse</span><span class="o">:</span> <span class="sr">/jquery|lodash/</span><span class="p">,</span> <span class="c1">// 正则表达式
</span><span class="c1"></span>    <span class="c1">// 或者使用函数
</span><span class="c1"></span>    <span class="nx">noParse</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="sr">/jquery|lodash/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>使用 noParse 进行忽略的模块文件中不能使用 import、require、define 等导入机制</p>
<h3 id="defineplugin">DefinePlugin</h3>
<p>DefinePlugin创建一些在编译时可以配置的全局常量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">DefinePlugin</span><span class="p">({</span>
    <span class="nx">PRODUCTION</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
    <span class="nx">VERSION</span><span class="o">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
    <span class="nx">EXPRESSION</span><span class="o">:</span> <span class="s2">&#34;1+2&#34;</span><span class="p">,</span>
    <span class="nx">COPYRIGHT</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">AUTHOR</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="s2">&#34;珠峰培训&#34;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">})</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">PRODUCTION</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">VERSION</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">EXPRESSION</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">COPYRIGHT</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>如果配置的值是字符串，那么整个字符串会被当成代码片段来执行，其结果作为最终变量的值
如果配置的值不是字符串，也不是一个对象字面量，那么该值会被转为一个字符串，如 true，最后的结果是 &lsquo;true&rsquo;
如果配置的是一个对象字面量，那么该对象的所有 key 会以同样的方式去定义
<code>JSON.stringify(true)</code> 的结果是 &lsquo;true&rsquo;</p>
<h3 id="ignoreplugin">IgnorePlugin</h3>
<p>IgnorePlugin用于忽略某些特定的模块，让 webpack 不把这些指定的模块打包进去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">moment</span> <span class="nx">from</span>  <span class="s1">&#39;moment&#39;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">moment</span><span class="p">);</span>
<span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">IgnorePlugin</span><span class="p">(</span><span class="sr">/^\.\/locale/</span><span class="p">,</span><span class="sr">/moment$/</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>第一个是匹配引入模块路径的正则表达式</li>
<li>第二个是匹配模块的对应上下文，即所在目录名</li>
</ul>
<h3 id="区分环境变量">区分环境变量</h3>
<ul>
<li>日常的前端开发工作中，一般都会有两套构建环境</li>
<li>一套开发时使用，构建结果用于本地开发调试，不进行代码压缩，打印 debug 信息，包含 sourcemap 文件</li>
<li>一套构建后的结果是直接应用于线上的，即代码都是压缩后，运行时不打印 debug 信息，静态文件不包括 sourcemap</li>
<li>webpack 4.x 版本引入了 mode 的概念
当你指定使用 production mode 时，默认会启用各种性能优化的功能，包括构建结果优化以及 webpack 运行性能优化
而如果是 development mode 的话，则会开启 debug 工具，运行时打印详细的错误信息，以及更加快速的增量编译构建</li>
</ul>
<h4 id="环境差异">环境差异</h4>
<ul>
<li>生产环境
<ul>
<li>可能需要分离 CSS 成单独的文件，以便多个页面共享同一个 CSS 文件</li>
<li>需要压缩 HTML/CSS/JS 代码</li>
<li>需要压缩图片</li>
</ul>
</li>
<li>开发环境
<ul>
<li>需要生成 sourcemap 文件</li>
<li>需要打印 debug 信息</li>
<li>需要 live reload 或者 hot reload 的功能&hellip;</li>
</ul>
</li>
</ul>
<h4 id="获取mode参数">获取mode参数</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span><span class="o">-</span><span class="nx">dev</span> <span class="nx">optimize</span><span class="o">-</span><span class="nx">css</span><span class="o">-</span><span class="nx">assets</span><span class="o">-</span><span class="nx">webpack</span><span class="o">-</span><span class="nx">plugin</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">UglifyJSPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack/lib/optimize/UglifyJsPlugin&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">OptimizeCssAssetsPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;optimize-css-assets-webpack-plugin&#39;</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="o">=</span><span class="p">(</span><span class="nx">env</span><span class="p">,</span><span class="nx">argv</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span>
    <span class="nx">optimization</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">minimizer</span><span class="o">:</span> <span class="nx">argv</span><span class="p">.</span><span class="nx">mode</span> <span class="o">==</span> <span class="s1">&#39;production&#39;</span><span class="o">?</span><span class="p">[</span>
            <span class="k">new</span> <span class="nx">UglifyJSplugin</span><span class="p">({</span>
                  <span class="nx">cache</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">//启用缓存
</span><span class="c1"></span>                  <span class="nx">parallel</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span><span class="c1">// 使用多进程运行改进编译速度
</span><span class="c1"></span>                  <span class="nx">sourceMap</span><span class="o">:</span><span class="kc">true</span><span class="c1">//生成sourceMap映射文件
</span><span class="c1"></span>            <span class="p">}),</span>
            <span class="k">new</span> <span class="nx">OptimizeCssAssetsWebpackPlugin</span><span class="p">({})</span>
        <span class="p">]</span><span class="o">:</span><span class="p">[]</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="封装log方法">封装log方法</h4>
<p>webpack 时传递的 mode 参数，是可以在我们的应用代码运行时，通过 <code>process.env.NODE_ENV</code> 这个变量获取</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">log</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">==</span> <span class="s1">&#39;development&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span><span class="nx">args</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="拆分配置">拆分配置</h3>
<p>可以把 webpack 的配置按照不同的环境拆分成多个文件，运行时直接根据环境变量加载对应的配置即可</p>
<ul>
<li>webpack.base.js：基础部分，即多个文件中共享的配置</li>
<li>webpack.development.js：开发环境使用的配置</li>
<li>webpack.production.js：生产环境使用的配置</li>
<li>webpack.test.js：测试环境使用的配置&hellip;</li>
<li>webpack-merge</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="p">{</span> <span class="nx">smart</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack-merge&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpack&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">base</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./webpack.base.js&#39;</span><span class="p">)</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">smart</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">rules</span><span class="o">:</span> <span class="p">[],</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="多入口">多入口</h4>
<p>有时候我们的页面可以不止一个HTML页面，会有多个页面，所以就需要多入口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">path</span><span class="o">=</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">HtmlWebpackPlugin</span><span class="o">=</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;html-webpack-plugin&#39;</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="o">=</span><span class="p">{</span>
    <span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">index</span><span class="o">:</span> <span class="s1">&#39;./src/index.js&#39;</span><span class="p">,</span>
        <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;./src/login.js&#39;</span>
    <span class="p">},</span>
    <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;dist&#39;</span><span class="p">),</span>
        <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;[name].[hash].js&#39;</span><span class="p">,</span>
        <span class="nx">publicPath</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span>
    <span class="p">},</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">HtmlWebpackPlugin</span><span class="p">({</span>
            <span class="nx">minify</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">removeAttributeQuotes</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span>
            <span class="nx">hash</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;./src/index.html&#39;</span><span class="p">,</span>
            <span class="nx">chunks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;index.html&#39;</span>
        <span class="p">}),</span>
        <span class="k">new</span> <span class="nx">HtmlWebpackPlugin</span><span class="p">({</span>
            <span class="nx">minify</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">removeAttributeQuotes</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span>
            <span class="nx">hash</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">chunks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span>
            <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;./src/login.html&#39;</span><span class="p">,</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;login.html&#39;</span>
        <span class="p">})</span>
    <span class="p">],</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
        </div>
        <div class ='post_extra mb-2'>
          <div class = 'copy'></div>

        </div>
        <div>
        
        </div>
      </div>
    </div>
  </div>
  <a href = 'https://www.goyth.cn' class = 'post_nav'><span class = 'post_next'>The Latest</span>T</a>

    </main>
    <footer class = 'footer wrap pale'>
  <p>&copy;&nbsp;<span class = 'year'></span>&nbsp;Luke&#39;s blog</p>
  <p>Copyright © 2019, Luke and the Hugo Authors; all rights reserved.</p>
  <p>Designed by  <a href = 'https://www.linkedin.com/in/dan-weru-profile/' target = '_blank' title = 'Linkedin Profile' rel = 'nonopener'>Weru</a></p>
</footer>


<script src = 'https://www.goyth.cn/js/index.min.590d4a01cabdea4ec42a3c0446a8b2d428b6e84dbfb9d202e0ddfb6f81ed5592d1a05b37fa25d072fb7bf53bdaefe468c6b9ac78807ff4859f86d855c5cf7b30.js'></script>

  </body>
</html>
